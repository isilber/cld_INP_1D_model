


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>A Few Model Run Examples and Output Notebook &#8212; LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-rendered-html.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)’s documentation!" href="index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Welcome to LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)’s documentation!"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">A Few Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for cloud theme */

/* nicer titles and more space for info and warning logos */

div.admonition p.admonition-title {
    background: rgba(0, 0, 0, .05);
    margin: .5em -1em;
    margin-top: -.5em !important;
    padding: .5em .5em .5em 2.65em;
}

/* indent single paragraph */
div.admonition {
    text-indent: 20px;
}
/* don't indent multiple paragraphs */
div.admonition > p {
    text-indent: 0;
}
/* remove excessive padding */
div.admonition.inline-title p.admonition-title {
    padding-left: .2em;
}
</style>
<section id="A-Few-Model-Run-Examples-and-Output-Notebook">
<h1>A Few Model Run Examples and Output Notebook<a class="headerlink" href="#A-Few-Model-Run-Examples-and-Output-Notebook" title="Permalink to this headline">¶</a></h1>
<p>Let’s start with two basic model runs, one using ABIFM and the other using the singular approach (by default, the DeMott et al. (2010) size-dependent parametrization), each with a single monomodal INP population (diameter of 1 <span class="math notranslate nohighlight">\(\mu m\)</span>; <span class="math notranslate nohighlight">\(N_{INP}\ =\ 1\ L^{-1}\)</span>). Throughout the simulation, we use a single profile from the LES output (3 <span class="math notranslate nohighlight">\(h\)</span>; after the simulation reached a steady-state).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ABIFM</span>
<span class="n">model_abifm</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">entrain_from_cth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">inp_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_1&quot;</span><span class="p">,</span>                <span class="c1"># INP population #1 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}],</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>                               <span class="c1"># True - run model after initialization</span>

<span class="c1"># Singular</span>
<span class="n">model_singular</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">entrain_from_cth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">inp_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_1&quot;</span><span class="p">,</span>                <span class="c1"># INP population #1 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}],</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>                               <span class="c1"># True - run model after initialization</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 0.369729 s
10% of model run completed. Elapsed time: 0.54 s.
20% of model run completed. Elapsed time: 1.07 s.
30% of model run completed. Elapsed time: 1.61 s.
40% of model run completed. Elapsed time: 2.14 s.
50% of model run completed. Elapsed time: 2.68 s.
60% of model run completed. Elapsed time: 3.21 s.
70% of model run completed. Elapsed time: 3.75 s.
80% of model run completed. Elapsed time: 4.29 s.
90% of model run completed. Elapsed time: 4.83 s.

Model run finished! Total run time = 5.372252 s
Model run time stats:
Process: activation_inp: 0.83 s (15.42% of of total time)
Process: entrainment_inp: 0.54 s (10.04% of of total time)
Process: mixing_inp: 0.65 s (12.14% of of total time)
Process: sedimentation_ice: 0.57 s (10.67% of of total time)
Process: mixing_ice: 0.52 s (9.66% of of total time)
Process: data_allocation: 2.26 s (42.00% of of total time)


Model initalization done! Total processing time = 0.352265 s
10% of model run completed. Elapsed time: 0.69 s.
20% of model run completed. Elapsed time: 1.39 s.
30% of model run completed. Elapsed time: 2.07 s.
40% of model run completed. Elapsed time: 2.76 s.
50% of model run completed. Elapsed time: 3.45 s.
60% of model run completed. Elapsed time: 4.13 s.
70% of model run completed. Elapsed time: 4.80 s.
80% of model run completed. Elapsed time: 5.48 s.
90% of model run completed. Elapsed time: 6.16 s.

Model run finished! Total run time = 6.832876 s
Model run time stats:
Process: activation_inp: 1.53 s (22.38% of of total time)
Process: entrainment_inp: 0.57 s (8.30% of of total time)
Process: mixing_inp: 1.00 s (14.68% of of total time)
Process: sedimentation_ice: 0.59 s (8.59% of of total time)
Process: mixing_ice: 0.51 s (7.46% of of total time)
Process: data_allocation: 2.63 s (38.53% of of total time)


</pre></div></div>
</div>
<p>Now, we can use the internal <em>ci_model</em> object (or xarray) to generate some plots, in the example below nucleated ice time-height curtains and profile mean time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2e0</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2e0</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;singular&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;singular&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_4_0.png" src="_images/Example_4_0.png" />
</div>
</div>
<p>Let’s see the output fields in our model i/o xr.Dataset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_abifm</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8303a666-3f7e-4355-899b-d3a430989b02' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8303a666-3f7e-4355-899b-d3a430989b02' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-43f7a3c9-7a71-445c-8c25-4ca996993294' class='xr-section-summary-in' type='checkbox'  checked><label for='section-43f7a3c9-7a71-445c-8c25-4ca996993294' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-e9490293-4987-43f9-a81d-7794a85a078e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e9490293-4987-43f9-a81d-7794a85a078e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0c5cac5-acdd-4ede-9b60-80cca9939a53' class='xr-var-data-in' type='checkbox'><label for='data-c0c5cac5-acdd-4ede-9b60-80cca9939a53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><pre class='xr-var-data'>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.541672,  98.958336, 109.375   , 119.791672,
       130.208344, 140.625   , 151.041672, 161.458344, 171.875   , 182.291672,
       192.708344, 203.125   , 213.541672, 223.958344, 234.375   , 244.791672,
       255.208344, 265.625   , 276.041687, 286.458344, 296.875   , 307.291687,
       317.708344, 328.125   , 338.541687, 348.958344, 359.375   , 369.791687,
       380.208344, 390.625   , 401.041687, 411.458344, 421.875   , 432.291687,
       442.708344])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-9cd99807-4d54-467f-a6dd-ddacd997a840' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9cd99807-4d54-467f-a6dd-ddacd997a840' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-477fcfa4-4b6b-4a4f-9141-b54964438d34' class='xr-var-data-in' type='checkbox'><label for='data-477fcfa4-4b6b-4a4f-9141-b54964438d34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><pre class='xr-var-data'>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-0fff631e-1c70-4b5c-9298-73753d2e34ee' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0fff631e-1c70-4b5c-9298-73753d2e34ee' class='xr-section-summary' >Data variables: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>delta_z</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>10.42 10.42 10.42 ... 10.42 10.42</div><input id='attrs-c49f3e2e-9303-4c5c-a8d0-f6b21cb6a11a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c49f3e2e-9303-4c5c-a8d0-f6b21cb6a11a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd4ae23d-681d-4a87-a597-90b3b34165b4' class='xr-var-data-in' type='checkbox'><label for='data-bd4ae23d-681d-4a87-a597-90b3b34165b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><pre class='xr-var-data'>array([10.41666651, 10.41666794, 10.41666794, 10.41666412, 10.41666794,
       10.41666794, 10.41666412, 10.41667175, 10.41666412, 10.41666412,
       10.41667175, 10.41667175, 10.41665649, 10.41667175, 10.41667175,
       10.41665649, 10.41667175, 10.41667175, 10.41665649, 10.41667175,
       10.41667175, 10.41665649, 10.41667175, 10.41667175, 10.41665649,
       10.41668701, 10.41665649, 10.41665649, 10.41668701, 10.41665649,
       10.41665649, 10.41668701, 10.41665649, 10.41665649, 10.41668701,
       10.41665649, 10.41665649, 10.41668701, 10.41665649, 10.41665649,
       10.41668701, 10.41665649, 10.41665649])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>RH</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.8398 0.8398 ... 0.8329 0.8329</div><input id='attrs-94e89c88-e465-40af-b10e-1f45c06cc97f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-94e89c88-e465-40af-b10e-1f45c06cc97f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cd3de9a-f3b2-44f0-b504-679e8dc01b09' class='xr-var-data-in' type='checkbox'><label for='data-8cd3de9a-f3b2-44f0-b504-679e8dc01b09' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><pre class='xr-var-data'>array([[0.83984634, 0.83984634, 0.83984634, ..., 0.83984634, 0.83984634,
        0.83984634],
       [0.84531708, 0.84531708, 0.84531708, ..., 0.84531708, 0.84531708,
        0.84531708],
       [0.85068985, 0.85068985, 0.85068985, ..., 0.85068985, 0.85068985,
        0.85068985],
       ...,
       [0.99506836, 0.99506836, 0.99506836, ..., 0.99506836, 0.99506836,
        0.99506836],
       [0.95714996, 0.95714996, 0.95714996, ..., 0.95714996, 0.95714996,
        0.95714996],
       [0.83286148, 0.83286148, 0.83286148, ..., 0.83286148, 0.83286148,
        0.83286148]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>ql</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.337e-07 3.337e-07 ... 0.001123</div><input id='attrs-53d93ab5-6252-4db2-8d0d-889de975b772' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-53d93ab5-6252-4db2-8d0d-889de975b772' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6125f0df-5826-49e8-9279-1ef355e648b6' class='xr-var-data-in' type='checkbox'><label for='data-6125f0df-5826-49e8-9279-1ef355e648b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$g\:kg^{-1}$</dd></dl></div><pre class='xr-var-data'>array([[3.33709838e-07, 3.33709838e-07, 3.33709838e-07, ...,
        3.33709838e-07, 3.33709838e-07, 3.33709838e-07],
       [3.85450200e-07, 3.85450200e-07, 3.85450200e-07, ...,
        3.85450200e-07, 3.85450200e-07, 3.85450200e-07],
       [4.37495484e-07, 4.37495484e-07, 4.37495484e-07, ...,
        4.37495484e-07, 4.37495484e-07, 4.37495484e-07],
       ...,
       [4.01232246e-02, 4.01232246e-02, 4.01232246e-02, ...,
        4.01232246e-02, 4.01232246e-02, 4.01232246e-02],
       [1.33425456e-02, 1.33425456e-02, 1.33425456e-02, ...,
        1.33425456e-02, 1.33425456e-02, 1.33425456e-02],
       [1.12262137e-03, 1.12262137e-03, 1.12262137e-03, ...,
        1.12262137e-03, 1.12262137e-03, 1.12262137e-03]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>T</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>256.8 256.8 256.8 ... 255.3 255.3</div><input id='attrs-bd84eb0e-da26-4d53-8f9a-c814501b2f8a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd84eb0e-da26-4d53-8f9a-c814501b2f8a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5247520-fac8-4bd3-bf45-e6bc56365a77' class='xr-var-data-in' type='checkbox'><label for='data-c5247520-fac8-4bd3-bf45-e6bc56365a77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$K$</dd></dl></div><pre class='xr-var-data'>array([[256.79629517, 256.79629517, 256.79629517, ..., 256.79629517,
        256.79629517, 256.79629517],
       [256.68988037, 256.68988037, 256.68988037, ..., 256.68988037,
        256.68988037, 256.68988037],
       [256.56628418, 256.56628418, 256.56628418, ..., 256.56628418,
        256.56628418, 256.56628418],
       ...,
       [253.24536133, 253.24536133, 253.24536133, ..., 253.24536133,
        253.24536133, 253.24536133],
       [253.87742615, 253.87742615, 253.87742615, ..., 253.87742615,
        253.87742615, 253.87742615],
       [255.3427887 , 255.3427887 , 255.3427887 , ..., 255.3427887 ,
        255.3427887 , 255.3427887 ]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02164 0.02164 ... 0.0006757</div><input id='attrs-3adb87b9-9630-4a48-b269-f8519249d41a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3adb87b9-9630-4a48-b269-f8519249d41a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29af6d4a-a963-4924-830b-addad5b2b0d0' class='xr-var-data-in' type='checkbox'><label for='data-29af6d4a-a963-4924-830b-addad5b2b0d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd></dl></div><pre class='xr-var-data'>array([[0.02163903, 0.02163903, 0.02163903, ..., 0.02163903, 0.02163903,
        0.02163903],
       [0.02199175, 0.02199175, 0.02199175, ..., 0.02199175, 0.02199175,
        0.02199175],
       [0.02232477, 0.02232477, 0.02232477, ..., 0.02232477, 0.02232477,
        0.02232477],
       ...,
       [0.00484512, 0.00484512, 0.00484512, ..., 0.00484512, 0.00484512,
        0.00484512],
       [0.00265046, 0.00265046, 0.00265046, ..., 0.00265046, 0.00265046,
        0.00265046],
       [0.00067567, 0.00067567, 0.00067567, ..., 0.00067567, 0.00067567,
        0.00067567]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>prec</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001015 0.0001015 ... 2.327e-08</div><input id='attrs-2fd6a308-f56c-4e91-8e16-55e49afe8883' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2fd6a308-f56c-4e91-8e16-55e49afe8883' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3738f70d-fec6-42c7-847e-5bf5a549f532' class='xr-var-data-in' type='checkbox'><label for='data-3738f70d-fec6-42c7-847e-5bf5a549f532' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$mm\:h^{-1}$</dd></dl></div><pre class='xr-var-data'>array([[1.01465179e-04, 1.01465179e-04, 1.01465179e-04, ...,
        1.01465179e-04, 1.01465179e-04, 1.01465179e-04],
       [1.06041523e-04, 1.06041523e-04, 1.06041523e-04, ...,
        1.06041523e-04, 1.06041523e-04, 1.06041523e-04],
       [1.09954563e-04, 1.09954563e-04, 1.09954563e-04, ...,
        1.09954563e-04, 1.09954563e-04, 1.09954563e-04],
       ...,
       [1.97328518e-06, 1.97328518e-06, 1.97328518e-06, ...,
        1.97328518e-06, 1.97328518e-06, 1.97328518e-06],
       [3.21811740e-07, 3.21811740e-07, 3.21811740e-07, ...,
        3.21811740e-07, 3.21811740e-07, 3.21811740e-07],
       [2.32664394e-08, 2.32664394e-08, 2.32664394e-08, ...,
        2.32664394e-08, 2.32664394e-08, 2.32664394e-08]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>w_e_ent</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001 0.0001 ... 0.0001 0.0001</div><input id='attrs-a94ac145-df56-4f84-b03d-b79aec701d07' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a94ac145-df56-4f84-b03d-b79aec701d07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c959c1be-507d-44cb-bf23-4b9b8c4b353e' class='xr-var-data-in' type='checkbox'><label for='data-c959c1be-507d-44cb-bf23-4b9b8c4b353e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Cloud-top entrainment rate</dd></dl></div><pre class='xr-var-data'>array([0.0001, 0.0001, 0.0001, ..., 0.0001, 0.0001, 0.0001])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>tau_mix</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.8e+03 1.8e+03 ... 1.8e+03 1.8e+03</div><input id='attrs-db3a0ba3-f135-4366-ac9e-8e4bfc8a4b78' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-db3a0ba3-f135-4366-ac9e-8e4bfc8a4b78' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1d3d529-b8e5-44b6-9e43-63f64eb1cad8' class='xr-var-data-in' type='checkbox'><label for='data-f1d3d529-b8e5-44b6-9e43-63f64eb1cad8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd><dt><span>long_name :</span></dt><dd>Boundary-layer mixing time scale</dd></dl></div><pre class='xr-var-data'>array([1800., 1800., 1800., ..., 1800., 1800., 1800.])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>mixing_mask</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... True True True</div><input id='attrs-0048199d-8807-4fa1-af7a-cbb60a21207c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0048199d-8807-4fa1-af7a-cbb60a21207c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a188fe2-e78f-4195-a587-0c15e6f881c2' class='xr-var-data-in' type='checkbox'><label for='data-7a188fe2-e78f-4195-a587-0c15e6f881c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Mixing-layer mask (True --&gt; mixed)</dd></dl></div><pre class='xr-var-data'>array([[ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       ...,
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>v_f_ice</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.3 0.3 0.3 0.3 ... 0.3 0.3 0.3 0.3</div><input id='attrs-0c30b5be-f352-4e51-b95e-e1f32a175cda' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c30b5be-f352-4e51-b95e-e1f32a175cda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-839c646d-5ebe-4b36-b7a0-b559f4df880b' class='xr-var-data-in' type='checkbox'><label for='data-839c646d-5ebe-4b36-b7a0-b559f4df880b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Number-weighted ice crystal fall velocity</dd></dl></div><pre class='xr-var-data'>array([0.3, 0.3, 0.3, ..., 0.3, 0.3, 0.3])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>delta_aw</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01277 -0.01277 ... -0.007703</div><input id='attrs-53b316dc-3e60-4490-8bbb-a9957c19f306' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-53b316dc-3e60-4490-8bbb-a9957c19f306' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e2754bb-1a00-4cb8-a40a-557c48ef3006' class='xr-var-data-in' type='checkbox'><label for='data-5e2754bb-1a00-4cb8-a40a-557c48ef3006' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><pre class='xr-var-data'>array([[-1.27699807e-02, -1.27699807e-02, -1.27699807e-02, ...,
        -1.27699807e-02, -1.27699807e-02, -1.27699807e-02],
       [-6.41115251e-03, -6.41115251e-03, -6.41115251e-03, ...,
        -6.41115251e-03, -6.41115251e-03, -6.41115251e-03],
       [-8.02944838e-06, -8.02944838e-06, -8.02944838e-06, ...,
        -8.02944838e-06, -8.02944838e-06, -8.02944838e-06],
       ...,
       [ 1.71598116e-01,  1.71598116e-01,  1.71598116e-01, ...,
         1.71598116e-01,  1.71598116e-01,  1.71598116e-01],
       [ 1.28565634e-01,  1.28565634e-01,  1.28565634e-01, ...,
         1.28565634e-01,  1.28565634e-01,  1.28565634e-01],
       [-7.70253734e-03, -7.70253734e-03, -7.70253734e-03, ...,
        -7.70253734e-03, -7.70253734e-03, -7.70253734e-03]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni_nuc</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 4.258e-05 ... 0.0002726</div><input id='attrs-00586745-7d89-4351-afac-02d50432afb6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-00586745-7d89-4351-afac-02d50432afb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ed41fdf-2bb4-4f4e-96da-85c11195ca62' class='xr-var-data-in' type='checkbox'><label for='data-4ed41fdf-2bb4-4f4e-96da-85c11195ca62' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Nucleated ice</dd></dl></div><pre class='xr-var-data'>array([[0.00000000e+00, 4.25764424e-05, 1.11183275e-04, ...,
        1.92508227e-02, 1.92227534e-02, 1.91947265e-02],
       [0.00000000e+00, 4.68545453e-05, 1.20039652e-04, ...,
        1.92490636e-02, 1.92210009e-02, 1.91929805e-02],
       [0.00000000e+00, 5.22641950e-05, 1.31269186e-04, ...,
        1.92465616e-02, 1.92185065e-02, 1.91904938e-02],
       ...,
       [0.00000000e+00, 7.29124692e-03, 1.28883819e-02, ...,
        1.60964854e-03, 1.60731233e-03, 1.60497966e-03],
       [0.00000000e+00, 1.54121461e-03, 2.66703959e-03, ...,
        7.43543109e-04, 7.42463366e-04, 7.41385252e-04],
       [0.00000000e+00, 3.89533421e-05, 9.15757736e-05, ...,
        2.73399643e-04, 2.73003150e-04, 2.72607255e-04]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>nuc_rate</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.636e-06 ... 1.258e-07</div><input id='attrs-c67ce9f9-27b3-42d2-af4b-8c6a73ff61e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c67ce9f9-27b3-42d2-af4b-8c6a73ff61e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fafcb18e-9cfc-40db-828c-8fd019bf8fb4' class='xr-var-data-in' type='checkbox'><label for='data-fafcb18e-9cfc-40db-828c-8fd019bf8fb4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}\:s^{-1}$</dd><dt><span>long_name :</span></dt><dd>Ice nucleation rate</dd></dl></div><pre class='xr-var-data'>array([[0.00000000e+00, 1.63594748e-06, 1.63591359e-06, ...,
        8.01774544e-08, 8.00606890e-08, 7.99440999e-08],
       [0.00000000e+00, 2.03675157e-06, 2.03670532e-06, ...,
        9.97722174e-08, 9.96269161e-08, 9.94818341e-08],
       [0.00000000e+00, 2.53962560e-06, 2.53956158e-06, ...,
        1.24330089e-07, 1.24149024e-07, 1.23968233e-07],
       ...,
       [0.00000000e+00, 9.39927168e-04, 9.35522569e-04, ...,
        2.15465487e-05, 2.15153551e-05, 2.14842087e-05],
       [0.00000000e+00, 2.13330662e-04, 2.13101692e-04, ...,
        8.31769318e-06, 8.30560455e-06, 8.29353416e-06],
       [0.00000000e+00, 1.94809751e-06, 1.94805413e-06, ...,
        1.26120026e-07, 1.25984229e-07, 1.25848637e-07]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>time_h</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-6d99db59-c7c9-4291-8cef-564d10e1e76e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6d99db59-c7c9-4291-8cef-564d10e1e76e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a72d03dc-45d9-46e3-8897-5dd050a06df8' class='xr-var-data-in' type='checkbox'><label for='data-a72d03dc-45d9-46e3-8897-5dd050a06df8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><pre class='xr-var-data'>array([0.00000000e+00, 2.77777778e-03, 5.55555556e-03, ...,
       5.99444444e+00, 5.99722222e+00, 6.00000000e+00])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-af48ca2f-5b9e-4303-a177-90750593e84e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-af48ca2f-5b9e-4303-a177-90750593e84e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>To examine the INP dataset we need to specify the population name (that way, we can call an xr.Dataset of each INP populationin, in the case of multiple INP populations). Let’s examine the difference in INP xr.Dataset fields for ABIFM and singular. Note that particle diameter currently has no impact on the singular approach (moreoever, in that case, nucleus type specification is not required).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_abifm</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s2">&quot;Al2O3_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-22c30b07-12e9-4d2e-a387-12567931a59b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-22c30b07-12e9-4d2e-a387-12567931a59b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b8f0cea7-2bbb-4e64-9aa0-137c6943452e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b8f0cea7-2bbb-4e64-9aa0-137c6943452e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-e1e53298-ea2f-4431-a2d9-e5c9863a019f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e1e53298-ea2f-4431-a2d9-e5c9863a019f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0dbbdbac-6ad7-4ec9-a713-e0bb477c62d4' class='xr-var-data-in' type='checkbox'><label for='data-0dbbdbac-6ad7-4ec9-a713-e0bb477c62d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd><dt><span>long_name :</span></dt><dd>Particle diameter</dd></dl></div><pre class='xr-var-data'>array([1.])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-73636c27-a313-4ad9-8223-df56a4edac1a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73636c27-a313-4ad9-8223-df56a4edac1a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a800138-a10f-4317-9534-7f8572a9e139' class='xr-var-data-in' type='checkbox'><label for='data-9a800138-a10f-4317-9534-7f8572a9e139' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><pre class='xr-var-data'>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.541672,  98.958336, 109.375   , 119.791672,
       130.208344, 140.625   , 151.041672, 161.458344, 171.875   , 182.291672,
       192.708344, 203.125   , 213.541672, 223.958344, 234.375   , 244.791672,
       255.208344, 265.625   , 276.041687, 286.458344, 296.875   , 307.291687,
       317.708344, 328.125   , 338.541687, 348.958344, 359.375   , 369.791687,
       380.208344, 390.625   , 401.041687, 411.458344, 421.875   , 432.291687,
       442.708344])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-2463ffd4-d6ed-4a1d-b2ae-d1382fd30c63' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2463ffd4-d6ed-4a1d-b2ae-d1382fd30c63' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1216e992-8fb7-4c33-8109-d7544db120c8' class='xr-var-data-in' type='checkbox'><label for='data-1216e992-8fb7-4c33-8109-d7544db120c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><pre class='xr-var-data'>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-a228077b-c7bc-44ac-8a4e-3c8c01abce40' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a228077b-c7bc-44ac-8a4e-3c8c01abce40' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0</div><input id='attrs-3a166309-9a96-437f-81d0-aa63c9bd98a8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a166309-9a96-437f-81d0-aa63c9bd98a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1aef95e0-8a0b-4a4a-a765-617c555ead84' class='xr-var-data-in' type='checkbox'><label for='data-1aef95e0-8a0b-4a4a-a765-617c555ead84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><pre class='xr-var-data'>array([2.])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.142e-08</div><input id='attrs-a26b3309-138e-4056-8128-cd9439ace5d0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a26b3309-138e-4056-8128-cd9439ace5d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abaf24d5-2ef8-40c4-af4d-8e1a46388cad' class='xr-var-data-in' type='checkbox'><label for='data-abaf24d5-2ef8-40c4-af4d-8e1a46388cad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$cm^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><pre class='xr-var-data'>array([3.14159265e-08])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>Jhet</span></div><div class='xr-var-dims'>(height, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.04 26.04 26.04 ... 31.0 31.0</div><input id='attrs-8f854358-64c2-4012-800f-6fd7878b1116' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f854358-64c2-4012-800f-6fd7878b1116' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ebdef86-8406-4f74-8499-7f17c626901a' class='xr-var-data-in' type='checkbox'><label for='data-9ebdef86-8406-4f74-8499-7f17c626901a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$cm^{-2} s{-1}$</dd><dt><span>long_name :</span></dt><dd>Heterogeneous ice nucleation rate coefficient</dd></dl></div><pre class='xr-var-data'>array([[   26.0369128 ,    26.0369128 ,    26.0369128 , ...,
           26.0369128 ,    26.0369128 ,    26.0369128 ],
       [   32.41590801,    32.41590801,    32.41590801, ...,
           32.41590801,    32.41590801,    32.41590801],
       [   40.41939681,    40.41939681,    40.41939681, ...,
           40.41939681,    40.41939681,    40.41939681],
       ...,
       [14959.40549497, 14959.40549497, 14959.40549497, ...,
        14959.40549497, 14959.40549497, 14959.40549497],
       [ 3395.26293437,  3395.26293437,  3395.26293437, ...,
         3395.26293437,  3395.26293437,  3395.26293437],
       [   31.00493478,    31.00493478,    31.00493478, ...,
           31.00493478,    31.00493478,    31.00493478]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>inp</span></div><div class='xr-var-dims'>(height, time, diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0 2.0 2.0 ... 0.1292 0.1291</div><input id='attrs-2147781e-ccdd-4021-bf83-a2cca09adc4b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2147781e-ccdd-4021-bf83-a2cca09adc4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb169652-28ee-4561-ad98-e8bd4a8935d7' class='xr-var-data-in' type='checkbox'><label for='data-bb169652-28ee-4561-ad98-e8bd4a8935d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>INP concentration per diameter bin</dd></dl></div><pre class='xr-var-data'>array([[[2.        ],
        [1.99995857],
        [1.99989233],
        ...,
        [0.09787685],
        [0.09773431],
        [0.09759199]],

       [[2.        ],
        [1.99995459],
        [1.99988438],
        ...,
        [0.09782923],
        [0.09768676],
        [0.09754451]],

       [[2.        ],
        [1.99994958],
        [1.99987441],
        ...,
        [0.09776955],
        [0.09762717],
        [0.09748501]],

       ...,

       [[2.        ],
        [1.99062779],
        [1.9813264 ],
        ...,
        [0.0457809 ],
        [0.04571462],
        [0.04564845]],

       [[2.        ],
        [1.99785338],
        [1.99569593],
        ...,
        [0.07786602],
        [0.07775286],
        [0.07763987]],

       [[2.        ],
        [1.99995547],
        [1.99988614],
        ...,
        [0.12934078],
        [0.12920158],
        [0.12906258]]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>time_h</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-4de44b33-c49e-4e86-832e-9b813c1d8c0b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4de44b33-c49e-4e86-832e-9b813c1d8c0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6158bed4-1143-4ee3-9046-082bb61897d4' class='xr-var-data-in' type='checkbox'><label for='data-6158bed4-1143-4ee3-9046-082bb61897d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><pre class='xr-var-data'>array([0.00000000e+00, 2.77777778e-03, 5.55555556e-03, ...,
       5.99444444e+00, 5.99722222e+00, 6.00000000e+00])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-6e63c3e2-84bf-4f74-ae27-5e91573a2347' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6e63c3e2-84bf-4f74-ae27-5e91573a2347' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_singular</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s2">&quot;Al2O3_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<title>Show/Hide data repr</title>
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<title>Show/Hide attributes</title>
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

.xr-wrap {
  min-width: 300px;
  max-width: 700px;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><div class='xr-wrap'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6c5cc158-05cb-4164-b133-3af6441b0d3f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6c5cc158-05cb-4164-b133-3af6441b0d3f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>T</span>: 301</li><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0ae1bae8-1eef-4994-9863-a7f2b5ce82e8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0ae1bae8-1eef-4994-9863-a7f2b5ce82e8' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>T</span></div><div class='xr-var-dims'>(T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>238.1 238.2 238.3 ... 268.0 268.1</div><input id='attrs-1cce0202-4d05-4d93-b444-2e705f63fd72' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1cce0202-4d05-4d93-b444-2e705f63fd72' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f25c75a0-6801-4ee5-8c95-42b6264acabc' class='xr-var-data-in' type='checkbox'><label for='data-f25c75a0-6801-4ee5-8c95-42b6264acabc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([238.15, 238.25, 238.35, ..., 267.95, 268.05, 268.15])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-9704f4a7-db3c-4b7e-9088-cc740012b6b9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9704f4a7-db3c-4b7e-9088-cc740012b6b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f05fbf0-ddd5-4c9f-940e-4578198e8488' class='xr-var-data-in' type='checkbox'><label for='data-8f05fbf0-ddd5-4c9f-940e-4578198e8488' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><pre class='xr-var-data'>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.541672,  98.958336, 109.375   , 119.791672,
       130.208344, 140.625   , 151.041672, 161.458344, 171.875   , 182.291672,
       192.708344, 203.125   , 213.541672, 223.958344, 234.375   , 244.791672,
       255.208344, 265.625   , 276.041687, 286.458344, 296.875   , 307.291687,
       317.708344, 328.125   , 338.541687, 348.958344, 359.375   , 369.791687,
       380.208344, 390.625   , 401.041687, 411.458344, 421.875   , 432.291687,
       442.708344])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-3dbb4b07-8aae-4a0f-9b15-bcbd2ab38082' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3dbb4b07-8aae-4a0f-9b15-bcbd2ab38082' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ffcb6b0-67f8-4a7d-9418-0f39e78aad90' class='xr-var-data-in' type='checkbox'><label for='data-9ffcb6b0-67f8-4a7d-9418-0f39e78aad90' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><pre class='xr-var-data'>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-d4613270-fbb0-42ef-a89a-484808199ddd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4613270-fbb0-42ef-a89a-484808199ddd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2517a4df-82a4-4502-b0ea-065e0c3e40a4' class='xr-var-data-in' type='checkbox'><label for='data-2517a4df-82a4-4502-b0ea-065e0c3e40a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd><dt><span>long_name :</span></dt><dd>Particle diameter</dd></dl></div><pre class='xr-var-data'>array([1.])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-89c7723b-b487-401a-84b3-75f5218c5c7e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-89c7723b-b487-401a-84b3-75f5218c5c7e' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0</div><input id='attrs-813cb359-7471-4649-bc4f-357caa18aeec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-813cb359-7471-4649-bc4f-357caa18aeec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8dc4382-e6b6-49e4-b2d2-fd41a3bc8791' class='xr-var-data-in' type='checkbox'><label for='data-e8dc4382-e6b6-49e4-b2d2-fd41a3bc8791' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><pre class='xr-var-data'>array([2.])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.142e-08</div><input id='attrs-3a0fdfda-75f2-42db-bf38-23b7d89560b0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a0fdfda-75f2-42db-bf38-23b7d89560b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-588a29d5-2435-48cc-acee-b202d8b80894' class='xr-var-data-in' type='checkbox'><label for='data-588a29d5-2435-48cc-acee-b202d8b80894' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$cm^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><pre class='xr-var-data'>array([3.14159265e-08])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>inp</span></div><div class='xr-var-dims'>(height, time, T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.177 0.1754 ... 1.548e-06</div><input id='attrs-bb7a1dc8-29ea-4790-a8a0-ccd68b79f9d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb7a1dc8-29ea-4790-a8a0-ccd68b79f9d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4df95d15-d6b1-42ed-ae26-3cb15d4d8b2c' class='xr-var-data-in' type='checkbox'><label for='data-4df95d15-d6b1-42ed-ae26-3cb15d4d8b2c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>INP concentration per temperature bin</dd></dl></div><pre class='xr-var-data'>array([[[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02283650e-03, 9.74938406e-04, 1.39311670e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02032567e-03, 9.72545159e-04, 1.38969693e-02],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.10323518e-06, 4.86425736e-06, 6.95067313e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.09072057e-06, 4.85232880e-06, 6.93362807e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.07823669e-06, 4.84042952e-06, 6.91662486e-05]],

       [[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02283650e-03, 9.74938406e-04, 1.39311670e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02032567e-03, 9.72545159e-04, 1.38969693e-02],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.10323518e-06, 4.86425736e-06, 6.95067313e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.09072057e-06, 4.85232880e-06, 6.93362807e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.07823669e-06, 4.84042952e-06, 6.91662486e-05]],

       [[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02283650e-03, 9.74938406e-04, 1.39311670e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02032567e-03, 9.72545159e-04, 1.38969693e-02],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.10323518e-06, 4.86425736e-06, 6.95067313e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.09072057e-06, 4.85232880e-06, 6.93362807e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         5.07823669e-06, 4.84042952e-06, 6.91662486e-05]],

       ...,

       [[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.17940343e-06, 3.03051613e-06, 4.33038910e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.17159876e-06, 3.02307695e-06, 4.31975904e-05],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.58756031e-08, 1.51321694e-08, 2.16227793e-07],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.58367026e-08, 1.50950906e-08, 2.15697963e-07],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.57978976e-08, 1.50581028e-08, 2.15169434e-07]],

       [[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.17940343e-06, 3.03051613e-06, 4.33038910e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.17159876e-06, 3.02307695e-06, 4.31975904e-05],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.58756031e-08, 1.51321694e-08, 2.16227793e-07],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.58367026e-08, 1.50950906e-08, 2.15697963e-07],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.57978976e-08, 1.50581028e-08, 2.15169434e-07]],

       [[1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.02535350e-03, 9.77337543e-04, 1.39654490e-02],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.27729061e-06, 3.12381938e-06, 4.46371271e-05],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         3.26948594e-06, 3.11638020e-06, 4.45308266e-05],
        ...,
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.13762780e-07, 1.08435418e-07, 1.54946396e-06],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.13723879e-07, 1.08398339e-07, 1.54893413e-06],
        [1.76969255e-01, 1.75389767e-01, 1.73821006e-01, ...,
         1.13685074e-07, 1.08361351e-07, 1.54840560e-06]]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>time_h</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-87089596-7c4b-4a0c-bf39-b3a405608c67' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-87089596-7c4b-4a0c-bf39-b3a405608c67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9ed58da-739b-4361-9576-bbcd922d2381' class='xr-var-data-in' type='checkbox'><label for='data-c9ed58da-739b-4361-9576-bbcd922d2381' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><pre class='xr-var-data'>array([0.00000000e+00, 2.77777778e-03, 5.55555556e-03, ...,
       5.99444444e+00, 5.99722222e+00, 6.00000000e+00])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-7cc7aa44-5ec3-4ba8-88ee-98d8d442b167' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7cc7aa44-5ec3-4ba8-88ee-98d8d442b167' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>When using ABIFM, we can see below how to print the ABIFM coefficient for a given INP population and where ABIFM coefficient table is stored:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m = </span><span class="si">%f</span><span class="s2">, c = </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_abifm</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s2">&quot;Al2O3_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s2">&quot;Al2O3_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">c</span><span class="p">))</span>
<span class="n">model_abifm</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s2">&quot;Al2O3_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">Jhet_coeff_table</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
m = 14.966390, c = 1.606710
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c</th>
      <th>sigma_c</th>
      <th>LCL_c</th>
      <th>UCL_c</th>
      <th>m</th>
      <th>sigma_m</th>
      <th>LCL_m</th>
      <th>UCL_m</th>
    </tr>
    <tr>
      <th>nucleus_type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ice nucleus</th>
      <td>c</td>
      <td>sigma_c</td>
      <td>LCL_c</td>
      <td>UCL_c</td>
      <td>m</td>
      <td>sigma_m</td>
      <td>LCL_m</td>
      <td>UCL_m</td>
    </tr>
    <tr>
      <th>N. atomus</th>
      <td>-17.12381</td>
      <td>0.27733</td>
      <td>-17.66751</td>
      <td>-16.5801</td>
      <td>83.95603</td>
      <td>1.17979</td>
      <td>81.64302</td>
      <td>86.26904</td>
    </tr>
    <tr>
      <th>T. pseudonana</th>
      <td>-10.4345</td>
      <td>0.17629</td>
      <td>-10.78012</td>
      <td>-10.08889</td>
      <td>59.66992</td>
      <td>0.79104</td>
      <td>58.11905</td>
      <td>61.22079</td>
    </tr>
    <tr>
      <th>Pahokee Peat</th>
      <td>-15.77884</td>
      <td>0.18337</td>
      <td>-16.13839</td>
      <td>-15.41929</td>
      <td>78.30951</td>
      <td>0.79777</td>
      <td>76.74529</td>
      <td>79.87374</td>
    </tr>
    <tr>
      <th>Leonardite</th>
      <td>-13.40148</td>
      <td>0.09931</td>
      <td>-13.59621</td>
      <td>-13.20675</td>
      <td>66.90259</td>
      <td>0.42911</td>
      <td>66.06118</td>
      <td>67.744</td>
    </tr>
    <tr>
      <th>Illite</th>
      <td>-10.66873</td>
      <td>0.07544</td>
      <td>-10.81666</td>
      <td>-10.5208</td>
      <td>54.48075</td>
      <td>0.33316</td>
      <td>53.8275</td>
      <td>55.134</td>
    </tr>
    <tr>
      <th>1-Nonadecanol</th>
      <td>-2.92414</td>
      <td>0.04322</td>
      <td>-3.00894</td>
      <td>-2.83934</td>
      <td>28.13797</td>
      <td>0.35129</td>
      <td>27.44871</td>
      <td>28.82723</td>
    </tr>
    <tr>
      <th>Kaolinite</th>
      <td>-10.54758</td>
      <td>0.38782</td>
      <td>-11.31377</td>
      <td>-9.7814</td>
      <td>54.58834</td>
      <td>1.39323</td>
      <td>51.8359</td>
      <td>57.34078</td>
    </tr>
    <tr>
      <th>Al2O3</th>
      <td>1.60671</td>
      <td>0.58271</td>
      <td>0.34784</td>
      <td>2.86558</td>
      <td>14.96639</td>
      <td>2.14742</td>
      <td>10.32717</td>
      <td>19.6056</td>
    </tr>
    <tr>
      <th>Fe2O3</th>
      <td>1.42411</td>
      <td>0.64593</td>
      <td>0.07672</td>
      <td>2.77149</td>
      <td>17.62106</td>
      <td>2.50034</td>
      <td>12.40544</td>
      <td>22.83668</td>
    </tr>
    <tr>
      <th>Fungal Spores</th>
      <td>0.97931</td>
      <td>1.29892</td>
      <td>-3.15444</td>
      <td>5.11306</td>
      <td>15.47856</td>
      <td>4.7061</td>
      <td>0.50162</td>
      <td>30.45549</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As mentioned above, we can also use xarray to examine the model output. While we can still use the two model objects from above, let us run two additional simulations using the model’s default PSD (<span class="math notranslate nohighlight">\(D_{mean}\ =\ 1\ \mu m\)</span>, SD = 2.5, 35 PSD bins, <span class="math notranslate nohighlight">\(D_{min}\ =\ 0.01\ \mu m\)</span>, and bin mass ratio of 2). Here, we use 6 h long model run. in the first simulation, the LES sounding we use represents the simulation mean between 3-6 h (after steady state), while in the second we inform the model
with the full (un-averaged) LES output. Note that ABIFM, LES output temporal averaging, and the PSD parameters are all used by default, so these can be specified when calling the model, but are not required in this case. Note that in both simulations we specified the mixing layer as only occurring within cloud boundaries (see figures below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>

<span class="c1"># Average LES in time</span>
<span class="n">model_def</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>                           <span class="c1"># 1D model simulation time</span>
                 <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;ql_cbh&quot;</span><span class="p">,</span> <span class="s2">&quot;ql_cbh&quot;</span><span class="p">),</span>           <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_cbh&quot; for cloud base/top)</span>
                 <span class="n">inp_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span>           <span class="c1"># INP population #4 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}</span>
                          <span class="p">],</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span>                   <span class="c1"># time(s) to harvest from the LES model output</span>

<span class="c1"># Use full LES output to inform the model</span>
<span class="n">model_def_no_les_ave</span> <span class="o">=</span>   <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>                      <span class="c1"># 1D model simulation time</span>
                         <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;ql_cbh&quot;</span><span class="p">,</span> <span class="s2">&quot;ql_cbh&quot;</span><span class="p">),</span>           <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_cbh&quot; for cloud base/top)</span>
                         <span class="n">t_averaged_les</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                         <span class="c1"># True - time-averaged LES, False - LES evolution informs 1d model</span>
                         <span class="n">inp_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span>           <span class="c1"># INP population #4 properties</span>
                                    <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                    <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                                    <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}</span>
                                  <span class="p">],</span>
                         <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">))</span>                   <span class="c1"># time(s) to harvest from the LES model output</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 1.290617 s
10% of model run completed. Elapsed time: 0.59 s.
20% of model run completed. Elapsed time: 1.18 s.
30% of model run completed. Elapsed time: 1.77 s.
40% of model run completed. Elapsed time: 2.37 s.
50% of model run completed. Elapsed time: 2.96 s.
60% of model run completed. Elapsed time: 3.54 s.
70% of model run completed. Elapsed time: 4.14 s.
80% of model run completed. Elapsed time: 4.73 s.
90% of model run completed. Elapsed time: 5.32 s.

Model run finished! Total run time = 5.910939 s
Model run time stats:
Process: activation_inp: 0.96 s (16.26% of of total time)
Process: entrainment_inp: 0.03 s (0.49% of of total time)
Process: mixing_inp: 1.26 s (21.40% of of total time)
Process: sedimentation_ice: 0.64 s (10.84% of of total time)
Process: mixing_ice: 0.56 s (9.43% of of total time)
Process: data_allocation: 2.45 s (41.50% of of total time)
Model initalization done! Total processing time = 2.971385 s
10% of model run completed. Elapsed time: 0.62 s.
20% of model run completed. Elapsed time: 1.20 s.
30% of model run completed. Elapsed time: 1.80 s.
40% of model run completed. Elapsed time: 2.40 s.
50% of model run completed. Elapsed time: 3.00 s.
60% of model run completed. Elapsed time: 3.63 s.
70% of model run completed. Elapsed time: 4.26 s.
80% of model run completed. Elapsed time: 4.90 s.
90% of model run completed. Elapsed time: 5.53 s.

Model run finished! Total run time = 6.178920 s
Model run time stats:
Process: activation_inp: 0.96 s (15.60% of of total time)
Process: entrainment_inp: 0.27 s (4.39% of of total time)
Process: mixing_inp: 1.27 s (20.48% of of total time)
Process: sedimentation_ice: 0.65 s (10.47% of of total time)
Process: mixing_ice: 0.56 s (9.01% of of total time)
Process: data_allocation: 2.47 s (39.97% of of total time)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_def_no_les_ave</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model_def</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mixing_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model_def_no_les_ave</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mixing_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_14_0.png" src="_images/Example_14_0.png" />
</div>
</div>
<p>The simulation below shows all model input options and capabilities of handling multiple INP populations that can be weighted vertically (introducing INP layers). Note that if weights larger than 1 are specified, the weight profile is normalized to have a maximum value of 1 (a message is printed on the screen to let the user know). In this simulation we use the full LES output, and specify 4 INP populations of different types (nucleus type, PSD, etc.). Here, our mixed layer goes from the surface
up to cloud top (note that “ql_cbh” applies to cloud base or cloud top, depending on the ‘mixing_bounds’ element (first or second).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span>                               <span class="c1"># 1D model simulation time</span>
                 <span class="n">delta_t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>                                   <span class="c1"># ∆t in s</span>
                 <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                               <span class="c1"># True - ABIFM, False - singular</span>
                 <span class="n">t_averaged_les</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                         <span class="c1"># True - time-averaged LES, False - LES evolution informs 1d model</span>
                 <span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">500.</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="c1"># None - use LES vertical grid, np.ndarray - custom vertical grid</span>
                 <span class="n">w_e_ent</span><span class="o">=</span><span class="mf">0.1e-3</span><span class="p">,</span>                               <span class="c1"># cloud-top entrainment value or time series</span>
                 <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ql_cbh&quot;</span><span class="p">),</span>                  <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_cbh&quot; for cloud base/top)</span>
                 <span class="n">entrain_from_cth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                        <span class="c1"># True - from cloud top, False domain top (infinite source)</span>
                 <span class="n">tau_mix</span><span class="o">=</span><span class="mf">1800.</span><span class="p">,</span>                                <span class="c1"># Mixing time scale value or time series</span>
                 <span class="n">v_f_ice</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>                                  <span class="c1"># number-weighted fall velocity (value, t-series, or curtain)</span>
                 <span class="n">in_cld_q_thresh</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>                         <span class="c1"># mixing ratio threshold for determining a cloud [g/kg]</span>
                 <span class="n">inp_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Illite_mono&quot;</span><span class="p">,</span>             <span class="c1"># INP population #1 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Illite&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;n_init_weight_prof&quot;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">]),</span>
                            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])}},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Kaolinite&quot;</span><span class="p">,</span>               <span class="c1"># INP population #2 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;logn&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                                   <span class="s2">&quot;geom_sd&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                   <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
                                   <span class="s2">&quot;diam_min&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                   <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Kaolinite&quot;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span>            <span class="c1"># INP population #3 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;n_init_weight_prof&quot;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]),</span>
                            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])}},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_custom&quot;</span><span class="p">,</span>            <span class="c1"># INP population #4 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;custom&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
                                   <span class="s2">&quot;dn_dlogD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
                                   <span class="s2">&quot;norm_to_n_init_max&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}</span>
                            <span class="p">],</span>
                 <span class="n">les_out_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                            <span class="c1"># path of LES output sounding file to inform the model</span>
                 <span class="n">les_out_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                        <span class="c1"># filename of LES sounding file to inform the model</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span>                        <span class="c1"># time(s) to harvest from the LES model output</span>
                 <span class="n">height_ind_2crop</span><span class="o">=</span><span class="mf">600.</span><span class="p">,</span>                        <span class="c1"># height indices or vals for LES cropping (&quot;ql_pbl&quot;: use ql thresh)</span>
                 <span class="n">cbh_det_method</span><span class="o">=</span><span class="s2">&quot;ql_cbh&quot;</span><span class="p">,</span>                      <span class="c1"># Method to detect cloud base (currently, only with a ql thresh)</span>
                 <span class="n">run_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                               <span class="c1"># True - run model after initialization</span>
<span class="c1">#model.ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 1.421295 s
10% of model run completed. Elapsed time: 0.56 s.
20% of model run completed. Elapsed time: 1.12 s.
30% of model run completed. Elapsed time: 1.70 s.
40% of model run completed. Elapsed time: 2.28 s.
50% of model run completed. Elapsed time: 2.85 s.
60% of model run completed. Elapsed time: 3.42 s.
70% of model run completed. Elapsed time: 3.99 s.
80% of model run completed. Elapsed time: 4.56 s.
90% of model run completed. Elapsed time: 5.12 s.

Model run finished! Total run time = 5.695382 s
Model run time stats:
Process: activation_inp: 1.18 s (20.78% of of total time)
Process: entrainment_inp: 0.58 s (10.13% of of total time)
Process: mixing_inp: 1.58 s (27.73% of of total time)
Process: sedimentation_ice: 0.20 s (3.56% of of total time)
Process: mixing_ice: 0.18 s (3.14% of of total time)
Process: data_allocation: 1.97 s (34.53% of of total time)


</pre></div></div>
</div>
<p>Let’s plot curtain plots of the model output for the INP population we named: “Al2O3_default”. Here, we show the population’s Jhet (depends on nucleus type and RH + T from the LES), temporal evoluation of the INP PSD at an altitude of 400 m (in-cloud), and the PSD profiles at initialization (t = 0 s) and 1 h into the simulation. Note the layer structure of the population at initialization as we used vertical weighting).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Jhet&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Jhet for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;diam&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">inp_z</span><span class="o">=</span><span class="mf">400.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;h = 400 m for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;diam&quot;</span><span class="p">,</span> <span class="n">inp_z</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;t = 0 h for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;diam&quot;</span><span class="p">,</span> <span class="n">inp_z</span><span class="o">=</span><span class="mf">3600.</span><span class="p">,</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;t = 1 h for Al2O3_default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_18_0.png" src="_images/Example_18_0.png" />
</div>
</div>
<p>We can also produce time series of different variables at specific heights, for example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">Height</span><span class="o">=</span><span class="p">[</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">300.</span><span class="p">,</span> <span class="mf">400.</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ice number concentration&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;nuc_rate&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;nucleation rate&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;INP conc.&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="n">xticklabel</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;mean INP conc. (based on 200, 300, and 400 m)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_20_0.png" src="_images/Example_20_0.png" />
</div>
</div>
<p>Finally, we can also plot profiles at different times. In the example below to the right, a simulation average profile of total INP concentration for each of the INP populations is shown (note that dn_dlogD is summed over all diameters in each population).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1800.</span><span class="p">,</span> <span class="mf">3600.</span><span class="p">,</span> <span class="mf">7200.</span><span class="p">],</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;nuc_rate&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1800.</span><span class="p">,</span> <span class="mf">3600.</span><span class="p">,</span> <span class="mf">7200.</span><span class="p">],</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1800.</span><span class="p">,</span> <span class="mf">3600.</span><span class="p">,</span> <span class="mf">7200.</span><span class="p">],</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Al2O3_custom&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Kaolinite&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_inp</span><span class="o">=</span><span class="s2">&quot;Illite_mono&quot;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_22_0.png" src="_images/Example_22_0.png" />
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="index.html"
                          title="Previous page">&larr; Welcome to LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)’s documentation!</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Example.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Welcome to LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)’s documentation!"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">LES-Informed Ice Formation Evaluation Column Model (LIIFE-CM)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">A Few Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Israel Silber, Ann Fridlind.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>