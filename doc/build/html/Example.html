


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Model Run Examples and Output Notebook &#8212; Aerosol-Cloud Column Model (AC-1D)  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-rendered-html.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!" href="index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for cloud theme */

/* nicer titles and more space for info and warning logos */

div.admonition p.admonition-title {
    background: rgba(0, 0, 0, .05);
    margin: .5em -1em;
    margin-top: -.5em !important;
    padding: .5em .5em .5em 2.65em;
}

/* indent single paragraph */
div.admonition {
    text-indent: 20px;
}
/* don't indent multiple paragraphs */
div.admonition > p {
    text-indent: 0;
}
/* remove excessive padding */
div.admonition.inline-title p.admonition-title {
    padding-left: .2em;
}
</style>
<section id="Model-Run-Examples-and-Output-Notebook">
<h1>Model Run Examples and Output Notebook<a class="headerlink" href="#Model-Run-Examples-and-Output-Notebook" title="Permalink to this headline">¶</a></h1>
<p>Let’s start with two basic model simulations; one using <a class="reference external" href="https://pubs.rsc.org/en/content/articlehtml/2013/fd/c3fd00035d">ABIFM</a>, and the other using a singular approach (by default, the <a class="reference external" href="https://www.pnas.org/content/107/25/11217">DeMott et al. (2010)</a> size-dependent parametrization). The model input, simulation, and output are received, performed, and provided in SI units, so when specifying the input, we should remain consistent with this approach (by default). Each model simulation is
initialized with a single monomodal aerosol population with arbitrary parameter values (diameter of <span class="math notranslate nohighlight">\(10^{-6}\)</span> <span class="math notranslate nohighlight">\(m\)</span> (1 micrometer); <span class="math notranslate nohighlight">\(N_{aer}\ =\ 2\cdot 10^{3}\ m^{-3}\)</span>). Throughout the simulation, we use a single profile from the LES output (3 <span class="math notranslate nohighlight">\(h\)</span>; after the simulation reached a steady-state).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ABIFM</span>
<span class="n">model_abifm</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">deplete_entrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert_Dust&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.0e3</span><span class="p">,</span>
                                  <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">},</span>
                                  <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}],</span>
                       <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Singular</span>
<span class="n">model_singular</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">deplete_entrained</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert_Dust&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.0e3</span><span class="p">,</span>
                                     <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">},</span>
                                     <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}],</span>
                          <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 0.775031 s
10% of model run completed. Elapsed time: 0.60 s.
20% of model run completed. Elapsed time: 1.20 s.
30% of model run completed. Elapsed time: 1.80 s.
40% of model run completed. Elapsed time: 2.39 s.
50% of model run completed. Elapsed time: 2.99 s.
60% of model run completed. Elapsed time: 3.59 s.
70% of model run completed. Elapsed time: 4.20 s.
80% of model run completed. Elapsed time: 4.80 s.
90% of model run completed. Elapsed time: 5.39 s.

Model run finished! Total run time = 6.017548 s
Model run time stats:
Process: activation_aer: 0.81 s (13.53% of of total time)
Process: entrainment_aer: 0.52 s (8.60% of of total time)
Process: mixing_aer: 0.64 s (10.66% of of total time)
Process: sedimentation_ice: 0.52 s (8.72% of of total time)
Process: mixing_ice: 0.50 s (8.32% of of total time)
Process: data_allocation: 2.99 s (49.69% of of total time)


Model initalization done! Total processing time = 0.790457 s
10% of model run completed. Elapsed time: 0.54 s.
20% of model run completed. Elapsed time: 1.08 s.
30% of model run completed. Elapsed time: 1.62 s.
40% of model run completed. Elapsed time: 2.16 s.
50% of model run completed. Elapsed time: 2.70 s.
60% of model run completed. Elapsed time: 3.25 s.
70% of model run completed. Elapsed time: 3.79 s.
80% of model run completed. Elapsed time: 4.33 s.
90% of model run completed. Elapsed time: 4.86 s.

Model run finished! Total run time = 5.441985 s
Model run time stats:
Process: activation_aer: 1.16 s (21.32% of of total time)
Process: entrainment_aer: 0.54 s (9.91% of of total time)
Process: mixing_aer: 0.70 s (12.80% of of total time)
Process: sedimentation_ice: 0.49 s (8.98% of of total time)
Process: mixing_ice: 0.48 s (8.80% of of total time)
Process: data_allocation: 2.03 s (37.34% of of total time)


</pre></div></div>
</div>
<p>Now, we can use the internal <em>ci_model</em> object (or xarray) to generate some plots, in the example below nucleated ice time-height curtains and profile mean time series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM (desert dust)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_singular</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Singular (DeMott et al., 2010)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">3e1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM (desert dust)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_singular</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">3e1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Singular (DeMott et al., 2010)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_4_0.png" src="_images/Example_4_0.png" />
</div>
</div>
<p>To some, it is more convenient to specify the aerosol input parameters (diameters and concentrations) in non-SI units such as <span class="math notranslate nohighlight">\(\mu m\)</span> and <span class="math notranslate nohighlight">\(L^{-1}\)</span>. If one wishes to use this feature, then the input concentration and/or diameter units need to be specified using the ‘input_conc_units’ and ‘input_diam_units’ keywords, respectively, as demonstrated below. In this case, unit conversion is performed during model initialization using the <a class="reference external" href="https://pint.readthedocs.io/en/stable/">pint</a>
unit conversion Python package (see <a class="reference external" href="https://github.com/hgrecco/pint/blob/master/pint/default_en.txt">pint’s documentation</a> for full list of acceptable string formats and units), but the model still runs and provides output in SI units (a message describing the conversion procedures is printed on the screen). Note that the output plots below are identical to those shown above because model initialization is practically identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># ABIFM</span>
<span class="n">model_abifm_nonSI_in</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert_Dust&quot;</span><span class="p">,</span>
                                           <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>  <span class="c1"># L^-1</span>
                                           <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>  <span class="c1"># um</span>
                                           <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}],</span>
                                <span class="n">input_conc_units</span><span class="o">=</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">,</span>
                                <span class="n">input_diam_units</span><span class="o">=</span><span class="s2">&quot;um&quot;</span><span class="p">,</span>
                                <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Singular</span>
<span class="n">model_singular_nonSI_in</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert_Dust&quot;</span><span class="p">,</span>
                                              <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>  <span class="c1"># L^-1</span>
                                              <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                                      <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>     <span class="c1"># um</span>
                                              <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}],</span>
                                   <span class="n">input_conc_units</span><span class="o">=</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">,</span>
                                   <span class="n">input_diam_units</span><span class="o">=</span><span class="s2">&quot;um&quot;</span><span class="p">,</span>
                                   <span class="n">t_harvest</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_abifm_nonSI_in</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">model_abifm_nonSI_in</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_abifm_nonSI_in</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM (desert dust)&quot;</span><span class="p">)</span>
<span class="n">model_singular_nonSI_in</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_singular_nonSI_in</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Singular (DeMott et al., 2010)&quot;</span><span class="p">)</span>
<span class="n">model_abifm_nonSI_in</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_abifm_nonSI_in</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">3e1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM (desert dust)&quot;</span><span class="p">)</span>
<span class="n">model_singular_nonSI_in</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_singular_nonSI_in</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">3e1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Singular (DeMott et al., 2010)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 0.763777 s
10% of model run completed. Elapsed time: 0.60 s.
20% of model run completed. Elapsed time: 1.20 s.
30% of model run completed. Elapsed time: 1.80 s.
40% of model run completed. Elapsed time: 2.40 s.
50% of model run completed. Elapsed time: 3.00 s.
60% of model run completed. Elapsed time: 3.60 s.
70% of model run completed. Elapsed time: 4.21 s.
80% of model run completed. Elapsed time: 4.81 s.
90% of model run completed. Elapsed time: 5.41 s.

Model run finished! Total run time = 6.100782 s
Model run time stats:
Process: activation_aer: 0.83 s (13.58% of of total time)
Process: entrainment_aer: 0.52 s (8.60% of of total time)
Process: mixing_aer: 0.65 s (10.65% of of total time)
Process: sedimentation_ice: 0.53 s (8.70% of of total time)
Process: mixing_ice: 0.50 s (8.27% of of total time)
Process: data_allocation: 3.04 s (49.77% of of total time)


&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 0.773410 s
10% of model run completed. Elapsed time: 0.54 s.
20% of model run completed. Elapsed time: 1.11 s.
30% of model run completed. Elapsed time: 1.66 s.
40% of model run completed. Elapsed time: 2.20 s.
50% of model run completed. Elapsed time: 2.74 s.
60% of model run completed. Elapsed time: 3.29 s.
70% of model run completed. Elapsed time: 3.83 s.
80% of model run completed. Elapsed time: 4.38 s.
90% of model run completed. Elapsed time: 4.93 s.

Model run finished! Total run time = 5.516992 s
Model run time stats:
Process: activation_aer: 1.18 s (21.30% of of total time)
Process: entrainment_aer: 0.55 s (9.90% of of total time)
Process: mixing_aer: 0.71 s (12.84% of of total time)
Process: sedimentation_ice: 0.49 s (8.93% of of total time)
Process: mixing_ice: 0.48 s (8.76% of of total time)
Process: data_allocation: 2.06 s (37.40% of of total time)


</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fdd54138590&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_6_2.png" src="_images/Example_6_2.png" />
</div>
</div>
<p>It is occasionally also more convenient to examine and/or plot the model output data in units such as <span class="math notranslate nohighlight">\(L^{-1}\)</span> for concentrations or <span class="math notranslate nohighlight">\(cm^{-2} s^{-1}\)</span> for Jhet. We can easily convert all of the ci_model object’s output fields using the ci_model class internal methods, which also take advantage of ‘pint’. Moreover, we can change the coordinates (height, time, diameter, temperature) associated with the different output variables to more convenient units as well, for example, time in
hours. When called, each of these methods informs us about the unit conversions that were made and the fields on which they were applied (as also performed in the ’_swap_diam_dim_to_from_um’, ’_swap_height_dim_to_from_km’, and ’_swap_T_dim_to_from_C’ internal unit conversion methods). Note that we changed the vmin, vmax, and ylim input parameters accordingly when calling the internal plotting methods (these ranges are set automatically if not explicitly specified).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_abifm</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">)</span>
<span class="n">model_singular</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">)</span>
<span class="n">model_abifm</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;cm^{-2} s^{-1}&quot;</span><span class="p">)</span>
<span class="n">model_abifm</span><span class="o">.</span><span class="n">_swap_time_dim_to_from_hr</span><span class="p">()</span>
<span class="n">model_singular</span><span class="o">.</span><span class="n">_swap_time_dim_to_from_hr</span><span class="p">()</span>

<span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">log_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;singular&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_abifm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">3e-2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ABIFM&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model_singular</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">3e-2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;singular&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The units of &#39;Ni&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;inp&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;Jhet&#39; in the &#39;Desert_Dust&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
Converting time dimension units from seconds to hours
Converting time dimension units from seconds to hours
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_8_1.png" src="_images/Example_8_1.png" />
</div>
</div>
<p>Let’s see the output fields in our model i/o xr.Dataset. Note that all concentration fields do not have now the default SI units of <span class="math notranslate nohighlight">\(m^{-3}\)</span> but <span class="math notranslate nohighlight">\(L^{-1}\)</span> instead, and that the ‘time_h’ coordinate representing the simulation time in hours serves as one of the ci_model object xr.Dataset’s dimensions (designated by the <strong>bold</strong> font).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_abifm</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (height: 43, time_h: 2161)
Coordinates:
  * height       (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time         (time_h) int64 0 10 20 30 40 ... 21560 21570 21580 21590 21600
    height_km    (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h       (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
Data variables: (12/16)
    delta_z      (height) float32 &lt;Quantity([10.416666  10.416668  10.416668 ...
    RH           (height, time_h) float64 &lt;Quantity([[0.83984634 0.83984634 0...
    ql           (height, time_h) float64 &lt;Quantity([[3.33709838e-10 3.337098...
    T            (height, time_h) float64 &lt;Quantity([[256.79629517 256.796295...
    Ni           (height, time_h) float64 &lt;Quantity([[0.02163903 0.02163903 0...
    prec         (height, time_h) float64 &lt;Quantity([[1.01465179e-04 1.014651...
    ...           ...
    mixing_mask  (height, time_h) bool True True True True ... True True True
    v_f_ice      (time_h) float64 &lt;Quantity([0.3 0.3 0.3 ... 0.3 0.3 0.3], &#x27;m...
    delta_aw     (height, time_h) float64 &lt;Quantity([[-1.27699807e-02 -1.2769...
    S_ice        (height, time_h) float64 &lt;Quantity([[0.98502259 0.98502259 0...
    Ni_nuc       (height, time_h) float64 &lt;Quantity([[0.00000000e+00 5.731655...
    nuc_rate     (height, time_h) float64 &lt;Quantity([[0.00000000e+00 1.443187...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4ca6836a-8af2-4d4e-82fa-4b08a349f6ba' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4ca6836a-8af2-4d4e-82fa-4b08a349f6ba' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2999c1c8-6379-4898-9734-cfbc2b102fed' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2999c1c8-6379-4898-9734-cfbc2b102fed' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-3cdbd8a1-f80d-4a88-8e83-d68031ddd858' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3cdbd8a1-f80d-4a88-8e83-d68031ddd858' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d9fb7f7-3dfe-4ac8-a8d5-192c281957d2' class='xr-var-data-in' type='checkbox'><label for='data-0d9fb7f7-3dfe-4ac8-a8d5-192c281957d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-19e25f49-629c-44f1-a81a-07e67111d529' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19e25f49-629c-44f1-a81a-07e67111d529' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff5c7dd7-4a37-4017-bd1b-d86b9ea3c535' class='xr-var-data-in' type='checkbox'><label for='data-ff5c7dd7-4a37-4017-bd1b-d86b9ea3c535' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-5c7c9b77-e311-447c-82dc-b901ea8ac647' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5c7c9b77-e311-447c-82dc-b901ea8ac647' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a637c0e-2e33-4b00-8267-3ed61d20600a' class='xr-var-data-in' type='checkbox'><label for='data-6a637c0e-2e33-4b00-8267-3ed61d20600a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-a668ab62-bb34-41a5-9683-3eb0ea7835ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a668ab62-bb34-41a5-9683-3eb0ea7835ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7966a1ba-c138-4e03-953a-3d6326d802d6' class='xr-var-data-in' type='checkbox'><label for='data-7966a1ba-c138-4e03-953a-3d6326d802d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c26264ec-7189-457a-bb19-5ba2d739c8d7' class='xr-section-summary-in' type='checkbox'  ><label for='section-c26264ec-7189-457a-bb19-5ba2d739c8d7' class='xr-section-summary' >Data variables: <span>(16)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>delta_z</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>&lt;Quantity([10.416666  10.416668 ...</div><input id='attrs-d94feec4-26b1-4335-9fc1-eabd977c8102' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d94feec4-26b1-4335-9fc1-eabd977c8102' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8900955c-c8ac-4916-9936-40a6a6e89c3d' class='xr-var-data-in' type='checkbox'><label for='data-8900955c-c8ac-4916-9936-40a6a6e89c3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[10.416666030883789 10.416667938232422 10.416667938232422<br> 10.416664123535156 10.416667938232422 10.416667938232422<br> 10.416664123535156 10.416671752929688 10.416664123535156<br> 10.416664123535156 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.416671752929688 10.416671752929688<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625 10.41668701171875 10.416656494140625<br> 10.416656494140625]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>RH</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.83984634 0.8398463...</div><input id='attrs-9720682f-6c04-4278-9034-e627f43a7a4e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9720682f-6c04-4278-9034-e627f43a7a4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1c9d10e-675b-4a0e-b8ca-7630192ab501' class='xr-var-data-in' type='checkbox'><label for='data-d1c9d10e-675b-4a0e-b8ca-7630192ab501' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.8398463439941406 0.8398463439941406 0.8398463439941406 ...<br>  0.8398463439941406 0.8398463439941406 0.8398463439941406]<br> [0.8453170776367188 0.8453170776367188 0.8453170776367188 ...<br>  0.8453170776367188 0.8453170776367188 0.8453170776367188]<br> [0.8506898498535156 0.8506898498535156 0.8506898498535156 ...<br>  0.8506898498535156 0.8506898498535156 0.8506898498535156]<br> ...<br> [0.995068359375 0.995068359375 0.995068359375 ... 0.995068359375<br>  0.995068359375 0.995068359375]<br> [0.9571499633789062 0.9571499633789062 0.9571499633789062 ...<br>  0.9571499633789062 0.9571499633789062 0.9571499633789062]<br> [0.8328614807128907 0.8328614807128907 0.8328614807128907 ...<br>  0.8328614807128907 0.8328614807128907 0.8328614807128907]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ql</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[3.33709838e-10 3.337...</div><input id='attrs-cff45d79-f7a6-4532-b438-96f5b8a56f25' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cff45d79-f7a6-4532-b438-96f5b8a56f25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dcda2aa1-74f0-4e42-92a3-ee35dddd48aa' class='xr-var-data-in' type='checkbox'><label for='data-dcda2aa1-74f0-4e42-92a3-ee35dddd48aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$kg\:kg^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[3.337098375411074e-10 3.337098375411074e-10 3.337098375411074e-10 ...<br>  3.337098375411074e-10 3.337098375411074e-10 3.337098375411074e-10]<br> [3.854501995359527e-10 3.854501995359527e-10 3.854501995359527e-10 ...<br>  3.854501995359527e-10 3.854501995359527e-10 3.854501995359527e-10]<br> [4.3749548428451135e-10 4.3749548428451135e-10 4.3749548428451135e-10<br>  ... 4.3749548428451135e-10 4.3749548428451135e-10<br>  4.3749548428451135e-10]<br> ...<br> [4.012322460766882e-05 4.012322460766882e-05 4.012322460766882e-05 ...<br>  4.012322460766882e-05 4.012322460766882e-05 4.012322460766882e-05]<br> [1.334254557150416e-05 1.334254557150416e-05 1.334254557150416e-05 ...<br>  1.334254557150416e-05 1.334254557150416e-05 1.334254557150416e-05]<br> [1.1226213700865628e-06 1.1226213700865628e-06 1.1226213700865628e-06<br>  ... 1.1226213700865628e-06 1.1226213700865628e-06<br>  1.1226213700865628e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[256.79629517 256.796...</div><input id='attrs-35248dfc-e2be-4097-ab6c-01e7d1bfedc1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35248dfc-e2be-4097-ab6c-01e7d1bfedc1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8e09fbe-2be3-4956-afed-81a9b8db3018' class='xr-var-data-in' type='checkbox'><label for='data-f8e09fbe-2be3-4956-afed-81a9b8db3018' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$K$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[256.7962951660156 256.7962951660156 256.7962951660156 ...<br>  256.7962951660156 256.7962951660156 256.7962951660156]<br> [256.68988037109375 256.68988037109375 256.68988037109375 ...<br>  256.68988037109375 256.68988037109375 256.68988037109375]<br> [256.5662841796875 256.5662841796875 256.5662841796875 ...<br>  256.5662841796875 256.5662841796875 256.5662841796875]<br> ...<br> [253.245361328125 253.245361328125 253.245361328125 ... 253.245361328125<br>  253.245361328125 253.245361328125]<br> [253.87742614746094 253.87742614746094 253.87742614746094 ...<br>  253.87742614746094 253.87742614746094 253.87742614746094]<br> [255.34278869628906 255.34278869628906 255.34278869628906 ...<br>  255.34278869628906 255.34278869628906 255.34278869628906]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>kelvin</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.02163903 0.0216390...</div><input id='attrs-4ac65305-5992-4bf4-acf3-cad914a96a58' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ac65305-5992-4bf4-acf3-cad914a96a58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e396aa09-7761-4ba5-94d5-347562280428' class='xr-var-data-in' type='checkbox'><label for='data-e396aa09-7761-4ba5-94d5-347562280428' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.021639027181663554 0.021639027181663554 0.021639027181663554 ...<br>  0.021639027181663554 0.021639027181663554 0.021639027181663554]<br> [0.02199174559791573 0.02199174559791573 0.02199174559791573 ...<br>  0.02199174559791573 0.02199174559791573 0.02199174559791573]<br> [0.02232477345387452 0.02232477345387452 0.02232477345387452 ...<br>  0.02232477345387452 0.02232477345387452 0.02232477345387452]<br> ...<br> [0.004845116563956254 0.004845116563956254 0.004845116563956254 ...<br>  0.004845116563956254 0.004845116563956254 0.004845116563956254]<br> [0.0026504619654588173 0.0026504619654588173 0.0026504619654588173 ...<br>  0.0026504619654588173 0.0026504619654588173 0.0026504619654588173]<br> [0.0006756703214705341 0.0006756703214705341 0.0006756703214705341 ...<br>  0.0006756703214705341 0.0006756703214705341 0.0006756703214705341]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prec</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[1.01465179e-04 1.014...</div><input id='attrs-2967f7e5-135b-4019-9e3a-fd58bc9d49c2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2967f7e5-135b-4019-9e3a-fd58bc9d49c2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1208015e-065f-4a4b-a1ad-36f830155fae' class='xr-var-data-in' type='checkbox'><label for='data-1208015e-065f-4a4b-a1ad-36f830155fae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$mm\:h^{-1}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.00010146517888642848 0.00010146517888642848 0.00010146517888642848<br>  ... 0.00010146517888642848 0.00010146517888642848<br>  0.00010146517888642848]<br> [0.0001060415233951062 0.0001060415233951062 0.0001060415233951062 ...<br>  0.0001060415233951062 0.0001060415233951062 0.0001060415233951062]<br> [0.0001099545625038445 0.0001099545625038445 0.0001099545625038445 ...<br>  0.0001099545625038445 0.0001099545625038445 0.0001099545625038445]<br> ...<br> [1.9732851797016338e-06 1.9732851797016338e-06 1.9732851797016338e-06<br>  ... 1.9732851797016338e-06 1.9732851797016338e-06<br>  1.9732851797016338e-06]<br> [3.218117399228504e-07 3.218117399228504e-07 3.218117399228504e-07 ...<br>  3.218117399228504e-07 3.218117399228504e-07 3.218117399228504e-07]<br> [2.3266439441727016e-08 2.3266439441727016e-08 2.3266439441727016e-08<br>  ... 2.3266439441727016e-08 2.3266439441727016e-08<br>  2.3266439441727016e-08]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>millimeter/planck_constant</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>w_e_ent</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([0.0001 0.0001 0.0001 ...</div><input id='attrs-4a3dc68c-1c2d-48ba-b333-4e72c4107369' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a3dc68c-1c2d-48ba-b333-4e72c4107369' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa4fa5ec-b5a2-4c44-8da0-0d3f3bb4188d' class='xr-var-data-in' type='checkbox'><label for='data-fa4fa5ec-b5a2-4c44-8da0-0d3f3bb4188d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Cloud-top entrainment rate</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[0.0001 0.0001 0.0001 ... 0.0001 0.0001 0.0001]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter/second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lowest_cbh</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([255.20834351 255.2083...</div><input id='attrs-fbad34a2-bbfa-4a50-8287-e25a4c2436ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fbad34a2-bbfa-4a50-8287-e25a4c2436ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6950fd32-28b2-43c6-a3f3-96912735c49c' class='xr-var-data-in' type='checkbox'><label for='data-6950fd32-28b2-43c6-a3f3-96912735c49c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Lowest cloud base height</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[255.20834350585938 255.20834350585938 255.20834350585938 ...<br> 255.20834350585938 255.20834350585938 255.20834350585938]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lowest_cth</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([442.70834351 442.7083...</div><input id='attrs-acf32ef9-9cc4-4f90-a45e-118ffe537fa4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-acf32ef9-9cc4-4f90-a45e-118ffe537fa4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25e9e7ec-47f2-40cb-8bb0-11e354b3ceb7' class='xr-var-data-in' type='checkbox'><label for='data-25e9e7ec-47f2-40cb-8bb0-11e354b3ceb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Lowest cloud top height</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[442.7083435058594 442.7083435058594 442.7083435058594 ...<br> 442.7083435058594 442.7083435058594 442.7083435058594]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tau_mix</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([1800. 1800. 1800. ......</div><input id='attrs-947e8276-aae5-451d-aafe-2ac72c42be56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-947e8276-aae5-451d-aafe-2ac72c42be56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7423f237-d9d8-4c36-bf39-ac869088f1e5' class='xr-var-data-in' type='checkbox'><label for='data-7423f237-d9d8-4c36-bf39-ac869088f1e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd><dt><span>long_name :</span></dt><dd>Boundary-layer mixing time scale</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[1800.0 1800.0 1800.0 ... 1800.0 1800.0 1800.0]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mixing_mask</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... True True True</div><input id='attrs-5cbd2276-edcf-495d-aa26-5d032ae14f92' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5cbd2276-edcf-495d-aa26-5d032ae14f92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-24757d23-81c7-44e8-bde8-dc53c7a03f20' class='xr-var-data-in' type='checkbox'><label for='data-24757d23-81c7-44e8-bde8-dc53c7a03f20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Mixing-layer mask (True --&gt; mixed)</dd></dl></div><div class='xr-var-data'><pre>array([[ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       ...,
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True],
       [ True,  True,  True, ...,  True,  True,  True]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v_f_ice</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([0.3 0.3 0.3 ... 0.3 0...</div><input id='attrs-960c99bc-9302-4922-a02e-4babca39d193' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-960c99bc-9302-4922-a02e-4babca39d193' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fba34672-b926-4e3e-bc37-d5c8c5353b24' class='xr-var-data-in' type='checkbox'><label for='data-fba34672-b926-4e3e-bc37-d5c8c5353b24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m/s$</dd><dt><span>long_name :</span></dt><dd>Number-weighted ice crystal fall velocity</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[0.3 0.3 0.3 ... 0.3 0.3 0.3]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter/second</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>delta_aw</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[-1.27699807e-02 -1.2...</div><input id='attrs-e2cdaad1-63be-426d-b99d-b0298467a495' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e2cdaad1-63be-426d-b99d-b0298467a495' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11f3e2f1-8023-4207-befb-8e026f7eabdf' class='xr-var-data-in' type='checkbox'><label for='data-11f3e2f1-8023-4207-befb-8e026f7eabdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[-0.012769980702450168 -0.012769980702450168 -0.012769980702450168 ...<br>  -0.012769980702450168 -0.012769980702450168 -0.012769980702450168]<br> [-0.006411152509410822 -0.006411152509410822 -0.006411152509410822 ...<br>  -0.006411152509410822 -0.006411152509410822 -0.006411152509410822]<br> [-8.029448375412862e-06 -8.029448375412862e-06 -8.029448375412862e-06<br>  ... -8.029448375412862e-06 -8.029448375412862e-06<br>  -8.029448375412862e-06]<br> ...<br> [0.17159811647823164 0.17159811647823164 0.17159811647823164 ...<br>  0.17159811647823164 0.17159811647823164 0.17159811647823164]<br> [0.12856563355287665 0.12856563355287665 0.12856563355287665 ...<br>  0.12856563355287665 0.12856563355287665 0.12856563355287665]<br> [-0.0077025373431218735 -0.0077025373431218735 -0.0077025373431218735<br>  ... -0.0077025373431218735 -0.0077025373431218735<br>  -0.0077025373431218735]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>S_ice</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.98502259 0.9850225...</div><input id='attrs-bc9aec8d-f4d1-4437-b58a-ba6059241b78' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc9aec8d-f4d1-4437-b58a-ba6059241b78' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-507fe24d-ffdd-47a0-aef2-2ed61bf1ef95' class='xr-var-data-in' type='checkbox'><label for='data-507fe24d-ffdd-47a0-aef2-2ed61bf1ef95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.9850225941815102 0.9850225941815102 0.9850225941815102 ...<br>  0.9850225941815102 0.9850225941815102 0.9850225941815102]<br> [0.9924727720856324 0.9924727720856324 0.9924727720856324 ...<br>  0.9924727720856324 0.9924727720856324 0.9924727720856324]<br> [0.9999905613396122 0.9999905613396122 0.9999905613396122 ...<br>  0.9999905613396122 0.9999905613396122 0.9999905613396122]<br> ...<br> [1.2083841134011002 1.2083841134011002 1.2083841134011002 ...<br>  1.2083841134011002 1.2083841134011002 1.2083841134011002]<br> [1.1551630038427958 1.1551630038427958 1.1551630038427958 ...<br>  1.1551630038427958 1.1551630038427958 1.1551630038427958]<br> [0.9908364655425822 0.9908364655425822 0.9908364655425822 ...<br>  0.9908364655425822 0.9908364655425822 0.9908364655425822]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>dimensionless</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ni_nuc</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 5.731...</div><input id='attrs-dc5bd061-24d6-4a2a-9559-b44e7ee6f834' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc5bd061-24d6-4a2a-9559-b44e7ee6f834' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-442dd5e1-8548-4db9-ba6d-7e80cefc3580' class='xr-var-data-in' type='checkbox'><label for='data-442dd5e1-8548-4db9-ba6d-7e80cefc3580' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Nucleated ice</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 5.731655432351244e-07 1.702053390113483e-06 ...<br>  0.013379263070027448 0.013378602641676078 0.013377942247589864]<br> [0.0 5.794562028598249e-07 1.7153509311804772e-06 ...<br>  0.013422500259325275 0.013421837701174123 0.013421175177397644]<br> [0.0 5.883695644282972e-07 1.7342554573451483e-06 ...<br>  0.013466546357572105 0.013465881629793598 0.013465216936501347]<br> ...<br> [0.0 0.00015834609841791316 0.00027577076916243405 ...<br>  0.0011480537082872162 0.0011479970492167457 0.0011479403930837633]<br> [0.0 1.6646601698007926e-05 2.9153439842496138e-05 ...<br>  0.0004657595134743796 0.0004657365257473407 0.0004657135392123094]<br> [0.0 5.704957895108654e-07 1.531536947064842e-06 ...<br>  0.00020994388940968455 0.00020993352740030196 0.000209923165928334]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nuc_rate</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 1.443...</div><input id='attrs-684a9b3d-02dc-4380-b03d-462805b020b5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-684a9b3d-02dc-4380-b03d-462805b020b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc3709a7-7c58-43b7-8854-d649e3f112c4' class='xr-var-data-in' type='checkbox'><label for='data-fc3709a7-7c58-43b7-8854-d649e3f112c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^{-3}\:s^{-1}$</dd><dt><span>long_name :</span></dt><dd>Ice nucleation rate</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 1.4431879859828648e-06 1.4431875735607143e-06 ...<br>  1.3085933022121984e-06 1.3085287274380553e-06 1.3084641560061186e-06]<br> [0.0 2.009831268492048e-06 2.009830688476684e-06 ...<br>  1.8223893327159834e-06 1.8222994037981256e-06 1.8222094795347332e-06]<br> [0.0 2.8054222832583814e-06 2.805421462546291e-06 ...<br>  2.5437796942918587e-06 2.5436541671330182e-06 2.5435286464711073e-06]<br> ...<br> [0.0 0.021366297104809067 0.021364021240063185 ... 0.019006934366148528<br>  0.019005996432273804 0.019005058547011244]<br> [0.0 0.0022716138051053847 0.002271587514436724 ...<br>  0.0020555445517873323 0.002055443117352536 0.0020553416881686102]<br> [0.0 1.8790938607599807e-06 1.8790933196972057e-06 ...<br>  1.7065519648291567e-06 1.7064693191295567e-06 1.706386677707965e-06]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/(meter<sup>3</sup> second)</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-62c4ab67-c7d3-49ea-aa1b-3457fef76794' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-62c4ab67-c7d3-49ea-aa1b-3457fef76794' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>To examine the aerosol dataset we need to specify the population name (that way, we can call an xr.Dataset of each INP populationin, in the case of multiple INP populations). Let’s examine the difference in aerosol xr.Dataset fields for ABIFM and singular. Note that some differences in the singular output fields exist when using an INAS parameterization (e.g., using the ‘ND2012’ string representing the <a class="reference external" href="https://journals.ametsoc.org/view/journals/atsc/69/10/jas-d-11-0249.1.xml">Niemand et al.,
2012</a> parameterization). It should also be noted that nucleus type specification is not required in the singular approach).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_abifm</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;Desert_Dust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (diam: 1, height: 43, time_h: 2161)
Coordinates:
  * diam       (diam) float64 1e-06
  * height     (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time       (time_h) int64 0 10 20 30 40 50 ... 21560 21570 21580 21590 21600
    height_km  (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h     (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
    diam_um    (diam) float64 1.0
Data variables:
    dn_dlogD   (diam) float64 &lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;
    surf_area  (diam) float64 &lt;Quantity([3.14159265e-12], &#x27;meter ** 2&#x27;)&gt;
    Jhet       (height, time_h) float64 &lt;Quantity([[2.29690502e-02 2.29690502...
    inp_pct    (height, time_h) float64 &lt;Quantity([[7.21593993e-07 7.21593993...
    n_aer      (height, time_h, diam) float64 &lt;Quantity([[[2.        ]   [1.9...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ad33b1e2-5358-44bb-b2b2-a2a85767a893' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ad33b1e2-5358-44bb-b2b2-a2a85767a893' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f51bff8c-c385-437e-b8e9-640284e4b116' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f51bff8c-c385-437e-b8e9-640284e4b116' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e-06</div><input id='attrs-d17e737e-d388-47fa-a3fc-e7bbc3ffc859' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d17e737e-d388-47fa-a3fc-e7bbc3ffc859' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-020ab3af-b680-4b7c-a400-36d884cce329' class='xr-var-data-in' type='checkbox'><label for='data-020ab3af-b680-4b7c-a400-36d884cce329' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Bin-middle particle diameter</dd></dl></div><div class='xr-var-data'><pre>array([1.e-06])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-7c7b53e1-9a4e-4c99-901d-9bddead041d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c7b53e1-9a4e-4c99-901d-9bddead041d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b5b60ca-6a71-465e-b4ce-3b24b9857dc1' class='xr-var-data-in' type='checkbox'><label for='data-1b5b60ca-6a71-465e-b4ce-3b24b9857dc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-5f6f333e-6a8d-4e14-880a-285614859a54' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f6f333e-6a8d-4e14-880a-285614859a54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86276c14-dfc8-423a-aa35-a41ed04a5175' class='xr-var-data-in' type='checkbox'><label for='data-86276c14-dfc8-423a-aa35-a41ed04a5175' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-8bd4ab69-d69d-4a30-810b-96ec5b1d5bc4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8bd4ab69-d69d-4a30-810b-96ec5b1d5bc4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7156410-4010-443b-91ad-4866ed2e6f5b' class='xr-var-data-in' type='checkbox'><label for='data-a7156410-4010-443b-91ad-4866ed2e6f5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-56e0361b-b600-4159-9b4a-53505bedc00b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-56e0361b-b600-4159-9b4a-53505bedc00b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ea53c3b-e7d1-4e82-87e7-d71917647821' class='xr-var-data-in' type='checkbox'><label for='data-1ea53c3b-e7d1-4e82-87e7-d71917647821' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>diam_um</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-a625149d-6ad9-400f-a2f4-c56135797ece' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a625149d-6ad9-400f-a2f4-c56135797ece' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f31badbc-0b83-436b-83d9-87f8ea67495f' class='xr-var-data-in' type='checkbox'><label for='data-f31badbc-0b83-436b-83d9-87f8ea67495f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd></dl></div><div class='xr-var-data'><pre>array([1.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dd109dce-d955-4e12-8798-9a8e1d6feb53' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dd109dce-d955-4e12-8798-9a8e1d6feb53' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;</div><input id='attrs-97eb92ee-8edd-4139-8b24-0ca6e7ee3f29' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97eb92ee-8edd-4139-8b24-0ca6e7ee3f29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0827791d-34ee-4160-9400-eca2e26582e7' class='xr-var-data-in' type='checkbox'><label for='data-0827791d-34ee-4160-9400-eca2e26582e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[2.0000000000000004]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([3.14159265e-12], &#x27;met...</div><input id='attrs-4d1e6ecd-fc78-431d-8ee7-afb62626b30e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4d1e6ecd-fc78-431d-8ee7-afb62626b30e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5e0fe36-0dbd-4938-bdb4-3d94c8de0b6d' class='xr-var-data-in' type='checkbox'><label for='data-b5e0fe36-0dbd-4938-bdb4-3d94c8de0b6d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[3.141592653589793e-12]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Jhet</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[2.29690502e-02 2.296...</div><input id='attrs-315846a6-d5aa-4643-86d3-0a90fee9cd7a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-315846a6-d5aa-4643-86d3-0a90fee9cd7a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d3d52f7-bbc1-4b7e-8ed2-05ecee9f8503' class='xr-var-data-in' type='checkbox'><label for='data-3d3d52f7-bbc1-4b7e-8ed2-05ecee9f8503' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$cm^{-2} s^{-1}$</dd><dt><span>long_name :</span></dt><dd>Heterogeneous ice nucleation rate coefficient</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.02296905017800099 0.02296905017800099 0.02296905017800099 ...<br>  0.02296905017800099 0.02296905017800099 0.02296905017800099]<br> [0.03198745811611638 0.03198745811611638 0.03198745811611638 ...<br>  0.03198745811611638 0.03198745811611638 0.03198745811611638]<br> [0.044649682384072284 0.044649682384072284 0.044649682384072284 ...<br>  0.044649682384072284 0.044649682384072284 0.044649682384072284]<br> ...<br> [340.05517998004154 340.05517998004154 340.05517998004154 ...<br>  340.05517998004154 340.05517998004154 340.05517998004154]<br> [36.153856587831136 36.153856587831136 36.153856587831136 ...<br>  36.153856587831136 36.153856587831136 36.153856587831136]<br> [0.029906707647358463 0.029906707647358463 0.029906707647358463 ...<br>  0.029906707647358463 0.029906707647358463 0.029906707647358463]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/(centimeter<sup>2</sup> second)</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp_pct</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[7.21593993e-07 7.215...</div><input id='attrs-8182b8da-dfd2-48ba-b249-faaed80dbfc1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8182b8da-dfd2-48ba-b249-faaed80dbfc1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea0a6ae8-d4b7-4866-9101-3bdf40adf997' class='xr-var-data-in' type='checkbox'><label for='data-ea0a6ae8-d4b7-4866-9101-3bdf40adf997' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$percent$</dd><dt><span>long_name :</span></dt><dd>INP percentage relative to total initial aerosol (using a time</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[7.215939929914324e-07 7.215939929914324e-07 7.215939929914324e-07 ...<br>  7.215939929914324e-07 7.215939929914324e-07 7.215939929914324e-07]<br> [1.0049156342460242e-06 1.0049156342460242e-06 1.0049156342460242e-06<br>  ... 1.0049156342460242e-06 1.0049156342460242e-06<br>  1.0049156342460242e-06]<br> [1.402711141629191e-06 1.402711141629191e-06 1.402711141629191e-06 ...<br>  1.402711141629191e-06 1.402711141629191e-06 1.402711141629191e-06]<br> ...<br> [0.010683148552404535 0.010683148552404535 0.010683148552404535 ...<br>  0.010683148552404535 0.010683148552404535 0.010683148552404535]<br> [0.0011358069025526924 0.0011358069025526924 0.0011358069025526924 ...<br>  0.0011358069025526924 0.0011358069025526924 0.0011358069025526924]<br> [9.395469303799904e-07 9.395469303799904e-07 9.395469303799904e-07 ...<br>  9.395469303799904e-07 9.395469303799904e-07 9.395469303799904e-07]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>percent</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>n_aer</span></div><div class='xr-var-dims'>(height, time_h, diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[[2.        ]   [1.99...</div><input id='attrs-ff8aab3a-cd53-42b3-a1c4-c539389ff462' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ff8aab3a-cd53-42b3-a1c4-c539389ff462' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1bad2578-0da5-49ce-a942-c85a98fc8e98' class='xr-var-data-in' type='checkbox'><label for='data-1bad2578-0da5-49ce-a942-c85a98fc8e98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>aerosol number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[[2.0000000000000004]<br>  [1.999999428456786]<br>  [1.999998302962012]<br>  ...<br>  [1.8133863919978503]<br>  [1.8132969075612226]<br>  [1.8132074277560712]]<br><br> [[2.0000000000000004]<br>  [1.9999994228218332]<br>  [1.9999982917234138]<br>  ...<br>  [1.8133854641095073]<br>  [1.8132959797186508]<br>  [1.8132064999592685]]<br><br> [[2.0000000000000004]<br>  [1.9999994149101226]<br>  [1.9999982759439487]<br>  ...<br>  [1.8133841613168267]<br>  [1.8132946769902354]<br>  [1.8132051972951146]]<br><br> ...<br><br> [[2.0000000000000004]<br>  [1.9997869668539463]<br>  [1.9995745827307776]<br>  ...<br>  [1.7790631983673009]<br>  [1.7789754072766912]<br>  [1.7788876207361852]]<br><br> [[2.0000000000000004]<br>  [1.9999768528712045]<br>  [1.9999532774722113]<br>  ...<br>  [1.8096765504180234]<br>  [1.8095872489850968]<br>  [1.809497952174974]]<br><br> [[2.0000000000000004]<br>  [1.999999424123738]<br>  [1.9999982943749672]<br>  ...<br>  [1.8162683139621274]<br>  [1.8161803551610078]<br>  [1.816092400912933]]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ef4eaf5a-7cc1-4b2b-bc82-2a7fb3519f0a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ef4eaf5a-7cc1-4b2b-bc82-2a7fb3519f0a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_singular</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;Desert_Dust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (T: 46, diam: 1, height: 43, time_h: 2161)
Coordinates:
  * T          (T) float64 253.0 253.1 253.2 253.3 ... 266.5 267.3 268.1 269.0
  * height     (height) float32 5.208 15.62 26.04 36.46 ... 421.9 432.3 442.7
    time       (time_h) int64 0 10 20 30 40 50 ... 21560 21570 21580 21590 21600
  * diam       (diam) float64 1e-06
    T_C        (T) float64 -20.15 -20.05 -19.94 -19.83 ... -5.851 -5.036 -4.18
    height_km  (height) float32 0.005208 0.01562 0.02604 ... 0.4323 0.4427
  * time_h     (time_h) float64 0.0 0.002778 0.005556 ... 5.994 5.997 6.0
    diam_um    (diam) float64 1.0
Data variables:
    dn_dlogD   (diam) float64 &lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;
    surf_area  (diam) float64 &lt;Quantity([3.14159265e-12], &#x27;meter ** 2&#x27;)&gt;
    ns_raw     (height, time_h) float64 &lt;Quantity([[0.00000000e+00 0.00000000...
    inp        (height, time_h, T) float64 &lt;Quantity([[[7.16660250e-06 1.1711...
    inp_pct    (height, time_h) float64 &lt;Quantity([[0.         0.         0. ...</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-97d68a58-a967-44bd-af01-e3bf800329fd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-97d68a58-a967-44bd-af01-e3bf800329fd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>T</span>: 46</li><li><span class='xr-has-index'>diam</span>: 1</li><li><span class='xr-has-index'>height</span>: 43</li><li><span class='xr-has-index'>time_h</span>: 2161</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-42b6aa59-5926-4081-a8ec-b99faa50fccb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-42b6aa59-5926-4081-a8ec-b99faa50fccb' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>T</span></div><div class='xr-var-dims'>(T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>253.0 253.1 253.2 ... 268.1 269.0</div><input id='attrs-7b9d9b25-5844-4599-881e-d9ebc77ad1eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7b9d9b25-5844-4599-881e-d9ebc77ad1eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df9ba0ec-cf50-4463-8603-aa7284e32c4d' class='xr-var-data-in' type='checkbox'><label for='data-df9ba0ec-cf50-4463-8603-aa7284e32c4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$K$</dd></dl></div><div class='xr-var-data'><pre>array([253.      , 253.1     , 253.205   , 253.31525 , 253.431012, 253.552563,
       253.680191, 253.814201, 253.954911, 254.102656, 254.257789, 254.420679,
       254.591713, 254.771298, 254.959863, 255.157856, 255.365749, 255.584037,
       255.813238, 256.0539  , 256.306595, 256.571925, 256.850521, 257.143048,
       257.4502  , 257.77271 , 258.111345, 258.466913, 258.840258, 259.232271,
       259.643885, 260.076079, 260.529883, 261.006377, 261.506696, 262.032031,
       262.583632, 263.162814, 263.770955, 264.409502, 265.079977, 265.783976,
       266.523175, 267.299334, 268.114301, 268.970016])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>height</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.208 15.62 26.04 ... 432.3 442.7</div><input id='attrs-5e8b3b02-7ec7-42f2-8aa5-64f38ba0d10a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5e8b3b02-7ec7-42f2-8aa5-64f38ba0d10a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-835ea7af-b036-4ac6-88b2-67fbdb6e0900' class='xr-var-data-in' type='checkbox'><label for='data-835ea7af-b036-4ac6-88b2-67fbdb6e0900' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd></dl></div><div class='xr-var-data'><pre>array([  5.208333,  15.625   ,  26.041668,  36.458336,  46.875   ,  57.291668,
        67.708336,  78.125   ,  88.54167 ,  98.958336, 109.375   , 119.79167 ,
       130.20834 , 140.625   , 151.04167 , 161.45834 , 171.875   , 182.29167 ,
       192.70834 , 203.125   , 213.54167 , 223.95834 , 234.375   , 244.79167 ,
       255.20834 , 265.625   , 276.0417  , 286.45834 , 296.875   , 307.2917  ,
       317.70834 , 328.125   , 338.5417  , 348.95834 , 359.375   , 369.7917  ,
       380.20834 , 390.625   , 401.0417  , 411.45834 , 421.875   , 432.2917  ,
       442.70834 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 10 20 30 ... 21580 21590 21600</div><input id='attrs-1be3d0a6-14eb-4120-a127-1796269dc3fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1be3d0a6-14eb-4120-a127-1796269dc3fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-142d0db5-6b62-4051-ba0a-a44935c7b3e8' class='xr-var-data-in' type='checkbox'><label for='data-142d0db5-6b62-4051-ba0a-a44935c7b3e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$s$</dd></dl></div><div class='xr-var-data'><pre>array([    0,    10,    20, ..., 21580, 21590, 21600])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>diam</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e-06</div><input id='attrs-27b6cbb9-d68e-4675-bcc6-dafbb404bed3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27b6cbb9-d68e-4675-bcc6-dafbb404bed3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-303edb33-c35a-44c5-a278-c644ca5cf1aa' class='xr-var-data-in' type='checkbox'><label for='data-303edb33-c35a-44c5-a278-c644ca5cf1aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m$</dd><dt><span>long_name :</span></dt><dd>Bin-middle particle diameter</dd></dl></div><div class='xr-var-data'><pre>array([1.e-06])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>T_C</span></div><div class='xr-var-dims'>(T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-20.15 -20.05 ... -5.036 -4.18</div><input id='attrs-0c048a5b-5ac0-4508-9ada-a6bef9cc98f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c048a5b-5ac0-4508-9ada-a6bef9cc98f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bb22d6e-9111-44dd-a962-f864cdaf5d81' class='xr-var-data-in' type='checkbox'><label for='data-9bb22d6e-9111-44dd-a962-f864cdaf5d81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$° C$</dd></dl></div><div class='xr-var-data'><pre>array([-20.15      , -20.05      , -19.945     , -19.83475   ,
       -19.7189875 , -19.59743687, -19.46980872, -19.33579915,
       -19.19508911, -19.04734357, -18.89221075, -18.72932128,
       -18.55828735, -18.37870172, -18.1901368 , -17.99214364,
       -17.78425082, -17.56596336, -17.33676153, -17.09609961,
       -16.84340459, -16.57807482, -16.29947856, -16.00695249,
       -15.69980011, -15.37729012, -15.03865462, -14.68308736,
       -14.30974172, -13.91772881, -13.50611525, -13.07392101,
       -12.62011706, -12.14362292, -11.64330406, -11.11796926,
       -10.56636773,  -9.98718611,  -9.37904542,  -8.74049769,
        -8.07002258,  -7.3660237 ,  -6.62682489,  -5.85066613,
        -5.03569944,  -4.17998441])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height_km</span></div><div class='xr-var-dims'>(height)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.005208 0.01562 ... 0.4323 0.4427</div><input id='attrs-f9e673c8-309f-4206-a2f9-019d3fc47ca6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9e673c8-309f-4206-a2f9-019d3fc47ca6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3635d402-4857-4b27-bd32-34f04dfb8040' class='xr-var-data-in' type='checkbox'><label for='data-3635d402-4857-4b27-bd32-34f04dfb8040' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$km$</dd></dl></div><div class='xr-var-data'><pre>array([0.00520833, 0.015625  , 0.02604167, 0.03645834, 0.046875  ,
       0.05729167, 0.06770834, 0.078125  , 0.08854167, 0.09895834,
       0.109375  , 0.11979167, 0.13020834, 0.140625  , 0.15104167,
       0.16145834, 0.171875  , 0.18229167, 0.19270834, 0.203125  ,
       0.21354167, 0.22395834, 0.234375  , 0.24479167, 0.25520834,
       0.265625  , 0.2760417 , 0.28645834, 0.296875  , 0.3072917 ,
       0.31770834, 0.328125  , 0.3385417 , 0.34895834, 0.359375  ,
       0.3697917 , 0.38020834, 0.390625  , 0.4010417 , 0.41145834,
       0.421875  , 0.4322917 , 0.44270834], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_h</span></div><div class='xr-var-dims'>(time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.002778 0.005556 ... 5.997 6.0</div><input id='attrs-6c01c360-dcbd-48a8-8c84-439676c5e4ce' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c01c360-dcbd-48a8-8c84-439676c5e4ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d263932-95c1-47a8-8bc4-36b4a69edf0b' class='xr-var-data-in' type='checkbox'><label for='data-7d263932-95c1-47a8-8bc4-36b4a69edf0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$h$</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.777778e-03, 5.555556e-03, ..., 5.994444e+00,
       5.997222e+00, 6.000000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>diam_um</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-13724d52-5eb9-4e4c-9e8d-d3e598f9f9f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-13724d52-5eb9-4e4c-9e8d-d3e598f9f9f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1fcf569-912e-49e7-91c5-7d9e2e6d0bab' class='xr-var-data-in' type='checkbox'><label for='data-a1fcf569-912e-49e7-91c5-7d9e2e6d0bab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$\mu m$</dd></dl></div><div class='xr-var-data'><pre>array([1.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dc697030-1801-487d-a2b1-15ba91ed7e57' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dc697030-1801-487d-a2b1-15ba91ed7e57' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>dn_dlogD</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([2.], &#x27;1 / liter&#x27;)&gt;</div><input id='attrs-e0150c10-7108-4370-b70d-aab354ec4259' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e0150c10-7108-4370-b70d-aab354ec4259' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6667691-a8d3-44dc-8b96-27b3945f51bf' class='xr-var-data-in' type='checkbox'><label for='data-e6667691-a8d3-44dc-8b96-27b3945f51bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>Particle number concentration per diameter bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[2.0000000000000004]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_area</span></div><div class='xr-var-dims'>(diam)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([3.14159265e-12], &#x27;met...</div><input id='attrs-0691d64a-d753-4857-ad68-c78864894f68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0691d64a-d753-4857-ad68-c78864894f68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb327c29-471e-474c-9caf-d953ed6ab429' class='xr-var-data-in' type='checkbox'><label for='data-eb327c29-471e-474c-9caf-d953ed6ab429' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$m^2$</dd><dt><span>long_name :</span></dt><dd>Surface area per particle diameter</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[3.141592653589793e-12]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ns_raw</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.00000000e+00 0.000...</div><input id='attrs-1ccbadcd-66b7-47ee-aa6a-c20ad3eb7bf4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1ccbadcd-66b7-47ee-aa6a-c20ad3eb7bf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0fe922f-6383-4394-b336-7d1ef0f09fe9' class='xr-var-data-in' type='checkbox'><label for='data-a0fe922f-6383-4394-b336-7d1ef0f09fe9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>INAS ns-equivalent singular treatment</dd><dt><span>units :</span></dt><dd>$m^{-2}$</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> ...<br> [7481182392.264709 7481182392.264709 7481182392.264709 ...<br>  7481182392.264709 7481182392.264709 7481182392.264709]<br> [7453528256.688641 7453528256.688641 7453528256.688641 ...<br>  7453528256.688641 7453528256.688641 7453528256.688641]<br> [7285677447.671117 7285677447.671117 7285677447.671117 ...<br>  7285677447.671117 7285677447.671117 7285677447.671117]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/meter<sup>2</sup></td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp</span></div><div class='xr-var-dims'>(height, time_h, T)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[[7.16660250e-06 1.17...</div><input id='attrs-996db735-a410-4643-ae45-7a858c7db117' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-996db735-a410-4643-ae45-7a858c7db117' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c69401e9-e229-434f-8187-f4bcd971b0bf' class='xr-var-data-in' type='checkbox'><label for='data-c69401e9-e229-434f-8187-f4bcd971b0bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$L^{-1}$</dd><dt><span>long_name :</span></dt><dd>INP number concentration per temperature bin</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 0.0024480126867784968 0.002113967196932679 0.0034453361604091775]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 0.002442003383747356 0.0021087778980565454 0.0034368786597010043]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   1.2213862592276089e-05 1.054721039942506e-05 1.7189805704322075e-05]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   1.2183910679938554e-05 1.052134559876086e-05 1.7147651344907494e-05]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   1.215403229296722e-05 1.0495544290501393e-05 1.7105600465186565e-05]]<br><br> ...<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.609446802437991e-06 6.571093774978339e-06<br>   1.0709545081504639e-05]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 7.590767450961843e-06 6.554963329048122e-06<br>   1.0683255738544378e-05]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   3.799598253522237e-08 3.2811210958382756e-08 5.347559401383215e-08]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   3.790287984177581e-08 3.273081266594124e-08 5.334456116498481e-08]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   3.781000569499277e-08 3.265061173364917e-08 5.321384997300161e-08]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.609446802437991e-06 6.571093774978339e-06<br>   1.0709545081504639e-05]<br>  [7.166602500340959e-06 1.170559346732765e-05 1.6940818903299918e-05<br>   ... 7.590767450961843e-06 6.554963329048122e-06<br>   1.0683255738544378e-05]<br>  ...<br>  [7.166602500340959e-06 6.714600258604762e-06 5.577591595596773e-06 ...<br>   3.799598253522237e-08 3.2811210958382756e-08 5.347559401383215e-08]<br>  [7.166602500340959e-06 6.712875489192066e-06 5.574732882566952e-06 ...<br>   3.790287984177581e-08 3.273081266594124e-08 5.334456116498481e-08]<br>  [7.166602500340959e-06 6.711151169423838e-06 5.571875653813761e-06 ...<br>   3.781000569499277e-08 3.265061173364917e-08 5.321384997300161e-08]]<br><br> [[7.166602500340959e-06 1.171164521513646e-05 1.695834237644789e-05 ...<br>   0.0024540367776295564 0.002119169265745174 0.003453814473513861]<br>  [7.166602500340959e-06 1.170861895022299e-05 1.6949578375219754e-05<br>   ... 7.84372574226372e-06 6.773403998450057e-06 1.1039269558572653e-05]<br>  [7.166602500340959e-06 1.1705593756235357e-05 1.6940819739970718e-05<br>   ... 7.82504639078757e-06 6.757273552519838e-06 1.1012980215612394e-05]<br>  ...<br>  [7.166602500340959e-06 6.793613390026124e-06 5.760444127893078e-06 ...<br>   2.722749223609512e-07 2.351214344300996e-07 3.832000710818484e-07]<br>  [7.166602500340959e-06 6.791919167335606e-06 5.757638594525045e-06 ...<br>   2.721818196675046e-07 2.350410361376581e-07 3.8306903823300104e-07]<br>  [7.166602500340959e-06 6.790225386327496e-06 5.754834517826257e-06 ...<br>   2.7208894552072153e-07 2.3496083520536604e-07 3.829383270410178e-07]]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>1/liter</td></tr></tbody></table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>inp_pct</span></div><div class='xr-var-dims'>(height, time_h)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>&lt;Quantity([[0.         0.       ...</div><input id='attrs-bc84ad82-afc5-4e7c-92bb-8aefc5b0671e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc84ad82-afc5-4e7c-92bb-8aefc5b0671e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34bc1fdc-493b-42da-9c32-bd77024f6656' class='xr-var-data-in' type='checkbox'><label for='data-34bc1fdc-493b-42da-9c32-bd77024f6656' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>$percent$</dd><dt><span>long_name :</span></dt><dd>INP parameterization percentage relative to total initial aerosol</dd></dl></div><div class='xr-var-data'><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> [0.0 0.0 0.0 ... 0.0 0.0 0.0]<br> ...<br> [2.3502827643704127 2.3502827643704127 2.3502827643704127 ...<br>  2.3502827643704127 2.3502827643704127 2.3502827643704127]<br> [2.3415949614536973 2.3415949614536973 2.3415949614536973 ...<br>  2.3415949614536973 2.3415949614536973 2.3415949614536973]<br> [2.2888630746028418 2.2888630746028418 2.2888630746028418 ...<br>  2.2888630746028418 2.2888630746028418 2.2888630746028418]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>percent</td></tr></tbody></table></div></li></ul></div></li><li class='xr-section-item'><input id='section-637440c2-7984-4e63-8bfa-29e19fe9bd3d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-637440c2-7984-4e63-8bfa-29e19fe9bd3d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>When using ABIFM, we can see below how to print the ABIFM coefficient for a given aerosol population and where ABIFM coefficient tables are stored:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m = </span><span class="si">%f</span><span class="s2">, c = </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_abifm</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;Desert_Dust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">model_abifm</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;Desert_Dust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">c</span><span class="p">))</span>
<span class="n">model_abifm</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;Desert_Dust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Jhet</span><span class="o">.</span><span class="n">Jhet_coeff_table</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
m = 22.620000, c = -1.350000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c</th>
      <th>sigma_c</th>
      <th>LCL_c</th>
      <th>UCL_c</th>
      <th>m</th>
      <th>sigma_m</th>
      <th>LCL_m</th>
      <th>UCL_m</th>
    </tr>
    <tr>
      <th>nucleus_type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ice nucleus</th>
      <td>c</td>
      <td>sigma_c</td>
      <td>LCL_c</td>
      <td>UCL_c</td>
      <td>m</td>
      <td>sigma_m</td>
      <td>LCL_m</td>
      <td>UCL_m</td>
    </tr>
    <tr>
      <th>N. atomus</th>
      <td>-17.12381</td>
      <td>0.27733</td>
      <td>-17.66751</td>
      <td>-16.5801</td>
      <td>83.95603</td>
      <td>1.17979</td>
      <td>81.64302</td>
      <td>86.26904</td>
    </tr>
    <tr>
      <th>T. pseudonana</th>
      <td>-10.4345</td>
      <td>0.17629</td>
      <td>-10.78012</td>
      <td>-10.08889</td>
      <td>59.66992</td>
      <td>0.79104</td>
      <td>58.11905</td>
      <td>61.22079</td>
    </tr>
    <tr>
      <th>Pahokee Peat</th>
      <td>-15.77884</td>
      <td>0.18337</td>
      <td>-16.13839</td>
      <td>-15.41929</td>
      <td>78.30951</td>
      <td>0.79777</td>
      <td>76.74529</td>
      <td>79.87374</td>
    </tr>
    <tr>
      <th>Leonardite</th>
      <td>-13.40148</td>
      <td>0.09931</td>
      <td>-13.59621</td>
      <td>-13.20675</td>
      <td>66.90259</td>
      <td>0.42911</td>
      <td>66.06118</td>
      <td>67.744</td>
    </tr>
    <tr>
      <th>Illite</th>
      <td>-10.66873</td>
      <td>0.07544</td>
      <td>-10.81666</td>
      <td>-10.5208</td>
      <td>54.48075</td>
      <td>0.33316</td>
      <td>53.8275</td>
      <td>55.134</td>
    </tr>
    <tr>
      <th>1-Nonadecanol</th>
      <td>-2.92414</td>
      <td>0.04322</td>
      <td>-3.00894</td>
      <td>-2.83934</td>
      <td>28.13797</td>
      <td>0.35129</td>
      <td>27.44871</td>
      <td>28.82723</td>
    </tr>
    <tr>
      <th>Kaolinite</th>
      <td>-10.54758</td>
      <td>0.38782</td>
      <td>-11.31377</td>
      <td>-9.7814</td>
      <td>54.58834</td>
      <td>1.39323</td>
      <td>51.8359</td>
      <td>57.34078</td>
    </tr>
    <tr>
      <th>Al2O3</th>
      <td>1.60671</td>
      <td>0.58271</td>
      <td>0.34784</td>
      <td>2.86558</td>
      <td>14.96639</td>
      <td>2.14742</td>
      <td>10.32717</td>
      <td>19.6056</td>
    </tr>
    <tr>
      <th>Fe2O3</th>
      <td>1.42411</td>
      <td>0.64593</td>
      <td>0.07672</td>
      <td>2.77149</td>
      <td>17.62106</td>
      <td>2.50034</td>
      <td>12.40544</td>
      <td>22.83668</td>
    </tr>
    <tr>
      <th>Fungal Spores</th>
      <td>0.97931</td>
      <td>1.29892</td>
      <td>-3.15444</td>
      <td>5.11306</td>
      <td>15.47856</td>
      <td>4.7061</td>
      <td>0.50162</td>
      <td>30.45549</td>
    </tr>
    <tr>
      <th>Desert Dust</th>
      <td>-1.35</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>22.62</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Feldspar (Herbert)</th>
      <td>-12.98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>122.83</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>soot (Schill)</th>
      <td>-2.08</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>18.07</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Upper tropos, At., china</th>
      <td>0.66</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2.98</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ACE-ENA gnd (Knopf)</th>
      <td>1.93</td>
      <td>0</td>
      <td>1.16</td>
      <td>2.7</td>
      <td>4.69</td>
      <td>0</td>
      <td>1.27</td>
      <td>8.11</td>
    </tr>
    <tr>
      <th>Fluka Kaolinite (Wex)</th>
      <td>-8.61</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>53.32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>As mentioned above, we can also use xarray to examine the model output. While we can still use the two model objects from above, let us initialize two additional simulations using the model’s default PSD (<span class="math notranslate nohighlight">\(D_{mean}\ =\ 1\ \mu m\)</span>, SD = 2.5, 35 PSD bins, <span class="math notranslate nohighlight">\(D_{min}\ =\ 0.01\ \mu m\)</span>, and bin mass ratio of 2). Here, we use 6 h long model run (note that run_model=False so the model only initializes). in the first simulation, the LES sounding we use represents the simulation mean between 3-6
h (after steady state), while in the second we inform the model with the full (un-averaged) prognosed LES output. Note that ABIFM, LES output temporal averaging, and the PSD parameters are all used by default, so these can be specified when calling the model, but are not required in this case. Note that in both simulations we specified the mixing layer as only occurring within cloud boundaries (see figures below).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>

<span class="c1"># Average LES in time</span>
<span class="n">model_def</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>                           <span class="c1"># 1D model simulation time</span>
                 <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;ql_thresh&quot;</span><span class="p">,</span> <span class="s2">&quot;ql_thresh&quot;</span><span class="p">),</span>     <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)</span>
                 <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DesertDust_default&quot;</span><span class="p">,</span>      <span class="c1"># Aerosol population properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}</span>
                          <span class="p">],</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span>                   <span class="c1"># time(s) to harvest from the LES model output</span>
                 <span class="n">run_model</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Use full LES output to inform the model</span>
<span class="n">model_def_no_les_ave</span> <span class="o">=</span>   <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>                      <span class="c1"># 1D model simulation time</span>
                         <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;ql_thresh&quot;</span><span class="p">,</span> <span class="s2">&quot;ql_thresh&quot;</span><span class="p">),</span>     <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)</span>
                         <span class="n">t_averaged_les</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                         <span class="c1"># True - time-averaged LES, False - LES evolution informs 1d model</span>
                         <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DesertDust_default&quot;</span><span class="p">,</span>      <span class="c1"># Aerosol population #4 properties</span>
                                    <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                    <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                                    <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}</span>
                                  <span class="p">],</span>
                         <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span>                        <span class="c1"># time(s) to harvest from the LES model output</span>
                         <span class="n">run_model</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model initalization done! Total processing time = 1.445254 s
Model initalization done! Total processing time = 3.232672 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model_def_no_les_ave</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model_def</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mixing_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">model_def_no_les_ave</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;mixing_mask&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_18_0.png" src="_images/Example_18_0.png" />
</div>
</div>
<p>The simulation below shows all model input options and capabilities of handling multiple aerosol populations that can be weighted vertically (introducing aerosol layers). Note that if weights larger than 1 are specified, the weight profile is normalized to have a maximum value of 1 (a message is printed on the screen to let the user know). In this simulation we use the full LES output, and specify 5 INP populations of different types (nucleus type, PSD, etc.). Here, our mixed layer goes from the
surface up to cloud top and note that we use again the option of specifying the input parameters in non-SI units.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">final_t</span><span class="o">=</span><span class="mi">3600</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>                               <span class="c1"># 1D model simulation time</span>
                 <span class="n">delta_t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>                                   <span class="c1"># ∆t in s</span>
                 <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                               <span class="c1"># True - ABIFM, False - singular</span>
                 <span class="n">t_averaged_les</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                         <span class="c1"># True - time-averaged LES, False - LES evolution informs 1d model</span>
                 <span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">500.</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">),</span> <span class="c1"># None - use LES vertical grid, np.ndarray - custom vertical grid</span>
                 <span class="n">w_e_ent</span><span class="o">=</span><span class="mf">0.1e-3</span><span class="p">,</span>                               <span class="c1"># cloud-top entrainment value or time series</span>
                 <span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ql_thresh&quot;</span><span class="p">),</span>               <span class="c1"># Mixing layer bounds (base, top) in m (&quot;ql_thresh&quot; for cloud base/top)</span>
                 <span class="n">deplete_entrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                       <span class="c1"># True - deplete aerosol from top, False -infinite (subsidising) entrainment source</span>
                 <span class="n">tau_mix</span><span class="o">=</span><span class="mf">1800.</span><span class="p">,</span>                                <span class="c1"># Mixing time scale value or time series</span>
                 <span class="n">v_f_ice</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>                                  <span class="c1"># number-weighted fall velocity (value, t-series, or curtain)</span>
                 <span class="n">in_cld_q_thresh</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>                         <span class="c1"># mixing ratio threshold for determining a cloud [kg/kg]</span>
                 <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Illite_mono&quot;</span><span class="p">,</span>             <span class="c1"># Aerosol population #1 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mono&quot;</span><span class="p">,</span>
                                   <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Illite&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;n_init_weight_prof&quot;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">]),</span>
                            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])}},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Kaolinite&quot;</span><span class="p">,</span>               <span class="c1"># Aerosol population #2 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;logn&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
                                    <span class="s2">&quot;geom_sd&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                                    <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
                                    <span class="s2">&quot;diam_min&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                                    <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Kaolinite&quot;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span>            <span class="c1"># Aerosol population #3 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;n_init_weight_prof&quot;</span><span class="p">:</span>
                            <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]),</span>
                            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])}},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DesertDust&quot;</span><span class="p">,</span>               <span class="c1"># Aerosol population #4 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4329777</span><span class="p">,</span> <span class="mi">640</span><span class="p">],</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_logn&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0744</span><span class="p">,</span> <span class="mf">2.251</span><span class="p">],</span>
                                    <span class="s2">&quot;geom_sd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.76</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span>
                                    <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                    <span class="s2">&quot;diam_min&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.014</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                                    <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">},</span>
                           <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3_custom&quot;</span><span class="p">,</span>            <span class="c1"># Aerosol population #5 properties</span>
                            <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;custom&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;diam&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
                                    <span class="s2">&quot;dn_dlogD&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
                                    <span class="s2">&quot;norm_to_n_init_max&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Al2O3&quot;</span><span class="p">}</span>
                            <span class="p">],</span>
                 <span class="n">les_out_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                            <span class="c1"># path of LES output sounding file to inform the model</span>
                 <span class="n">les_out_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                        <span class="c1"># filename of LES sounding file to inform the model</span>
                 <span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">6</span><span class="p">),</span>                        <span class="c1"># time(s) to harvest from the LES model output</span>
                 <span class="n">height_ind_2crop</span><span class="o">=</span><span class="mf">600.</span><span class="p">,</span>                        <span class="c1"># height indices or vals for LES cropping (&quot;ql_pbl&quot;: use ql thresh)</span>
                 <span class="n">cbh_det_method</span><span class="o">=</span><span class="s2">&quot;ql_thresh&quot;</span><span class="p">,</span>                   <span class="c1"># Method to detect cloud base (currently, only with a ql thresh)</span>
                 <span class="n">input_conc_units</span><span class="o">=</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">,</span>                    <span class="c1"># Specify alternative input concentartion units</span>
                 <span class="n">input_diam_units</span><span class="o">=</span><span class="s2">&quot;um&quot;</span><span class="p">,</span>                        <span class="c1"># Specify alternative input diameter units</span>
                 <span class="n">do_entrain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                              <span class="c1"># do entrainment in model run</span>
                 <span class="n">do_mix_aer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                              <span class="c1"># do aerosol mixing in model run</span>
                 <span class="n">do_mix_ice</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                              <span class="c1"># do ice mixing in model run</span>
                 <span class="n">do_sedim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                                <span class="c1"># do sedimentation in model run</span>
                 <span class="n">run_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                               <span class="c1"># True - run model after initialization</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Some heights were omitted because they are outside the processed LES dataset grid
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;n_init_max&#39; (in aer_info) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;dn_dlogD&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in L^{-1} units; now converted to m^{-3} (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_mean&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_min&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_mean&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam_min&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
&#39;diam&#39; (in aer_info&#39;s &#39;psd&#39; keys) was input in um units; now converted to m (SI)
Model initalization done! Total processing time = 2.511834 s
10% of model run completed. Elapsed time: 1.44 s.
20% of model run completed. Elapsed time: 2.89 s.
30% of model run completed. Elapsed time: 4.35 s.
40% of model run completed. Elapsed time: 5.80 s.
50% of model run completed. Elapsed time: 7.25 s.
60% of model run completed. Elapsed time: 8.71 s.
70% of model run completed. Elapsed time: 10.16 s.
80% of model run completed. Elapsed time: 11.62 s.
90% of model run completed. Elapsed time: 13.07 s.

Model run finished! Total run time = 14.611181 s
Model run time stats:
Process: activation_aer: 2.89 s (19.76% of of total time)
Process: entrainment_aer: 1.27 s (8.70% of of total time)
Process: mixing_aer: 2.89 s (19.76% of of total time)
Process: sedimentation_ice: 0.35 s (2.36% of of total time)
Process: mixing_ice: 0.34 s (2.33% of of total time)
Process: data_allocation: 6.77 s (46.33% of of total time)


</pre></div></div>
</div>
<p>Let’s plot curtain plots of the model output for the INP population we named: “Al2O3_default” (again, we convert the output units and some coordinates for convenience; note that requested coordinate values were adjusted accordignly). Here, we show the population’s Jhet (depends on nucleus type and RH + T from the LES), temporal evolution of the INP PSD at an altitude of 400 m (in-cloud), and the PSD profiles at initialization (t = 0 s) and 1 h into the simulation. Note the layer structure of the
population at initialization as we used vertical weighting).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;L^{-1}&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">_convert_quantity_units</span><span class="p">(</span><span class="s2">&quot;cm^{-2} s^{-1}&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">_swap_time_dim_to_from_hr</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">_swap_height_dim_to_from_km</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">_swap_diam_dim_to_from_um</span><span class="p">()</span>

<span class="n">cb</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Jhet&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Jhet for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">diam_dim</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">time_dim</span><span class="p">,</span> <span class="n">aer_z</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;h = 400 m for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">diam_dim</span><span class="p">,</span> <span class="n">aer_z</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;t = 0 h for Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">cb</span><span class="p">[</span><span class="s2">&quot;sub3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">curtain</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">diam_dim</span><span class="p">,</span> <span class="n">aer_z</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;t = 1 h for Al2O3_default&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The units of &#39;Ni&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Illite_mono&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Illite_mono&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Kaolinite&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Kaolinite&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_default&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_default&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;DesertDust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;DesertDust&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_custom&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_custom&#39; popolation converted from $m^{-3}$ to L^{-1}
The units of &#39;Ni&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;Ni_nuc&#39; converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Illite_mono&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Kaolinite&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_default&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;DesertDust&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;dn_dlogD&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;n_aer&#39; in the &#39;Al2O3_custom&#39; popolation converted from $L^{-1}$ to L^{-1}
The units of &#39;Jhet&#39; in the &#39;Illite_mono&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Kaolinite&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Al2O3_default&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;DesertDust&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
The units of &#39;Jhet&#39; in the &#39;Al2O3_custom&#39; popolation converted from $m^{-2} s^{-1}$ to cm^{-2} s^{-1}
Converting time dimension units from seconds to hours
Converting height dimension units from meters to kilometers
Converting diameter dimension units for Illite_mono from meters to micrometers
Converting diameter dimension units for Kaolinite from meters to micrometers
Converting diameter dimension units for Al2O3_default from meters to micrometers
Converting diameter dimension units for DesertDust from meters to micrometers
Converting diameter dimension units for Al2O3_custom from meters to micrometers
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_22_1.png" src="_images/Example_22_1.png" />
</div>
</div>
<p>We can also produce time series of different variables at specific heights, for example (note that here we customize the plots by specifying the x-axis label, xticks, and xlim input parameters available, among other optional parameters, in the internal plotting methods).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">XLim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Height</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">XLim</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total ice number concentration&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;nuc_rate&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">XLim</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Total nucleation rate&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">XLim</span><span class="p">,</span> <span class="n">Height_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Aerosol concentration for &#39;Al2O3_default&#39;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">tseries</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">,</span> <span class="n">Height</span><span class="o">=</span><span class="n">Height</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;time [h]&quot;</span><span class="p">,</span> <span class="n">xtick</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="n">XLim</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;mean aerosol conc. (for &#39;Al2O3_default&#39; at 3 heights)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_24_0.png" src="_images/Example_24_0.png" />
</div>
</div>
<p>Profile plots can also be generated using the internal methods at different times. In the example below to the right, a simulation average profile of total INP concentration for each of the INP populations is shown (note that dn_dlogD is summed over all diameters in each population).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">generate_figure</span><span class="p">(</span><span class="n">subplot_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;Ni_nuc&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="n">Times</span><span class="p">,</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;nuc_rate&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="n">Times</span><span class="p">,</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">field_to_plot</span><span class="o">=</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="n">Time</span><span class="o">=</span><span class="n">Times</span><span class="p">,</span> <span class="n">Time_dim_treat</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_default&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Al2O3_custom&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Kaolinite&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">which_pop</span><span class="o">=</span><span class="s2">&quot;Illite_mono&quot;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_26_0.png" src="_images/Example_26_0.png" />
</div>
</div>
<p>Finally, let’s perform three simulations using the three available approaches (ABIFM, INAS, and singular), and briefly examine their operation. The simualtions are initialized identically (hence we define the input paramters before calling the generation of the ci_model class), and represent real PSD of desert dust (from the SGP site; obviously, these elevated values do not match the Arctic case harvested from the LES).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">init_model</span> <span class="kn">import</span> <span class="n">ci_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">delta_t</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># time setp</span>
<span class="n">aer_info</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;DesertDust&quot;</span><span class="p">,</span>             <span class="c1"># INP population #1 properties</span>
             <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">4329777e3</span><span class="p">,</span> <span class="mf">640e3</span><span class="p">],</span> <span class="c1"># SGP 10/15 PM</span>
             <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_logn&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0744e-6</span><span class="p">,</span> <span class="mf">2.251e-6</span><span class="p">],</span>
                     <span class="s2">&quot;geom_sd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.76</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span>
                     <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                     <span class="s2">&quot;diam_min&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.014e-6</span><span class="p">,</span> <span class="mf">20e-6</span><span class="p">),</span>
                     <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">},</span>
            <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Desert Dust&quot;</span><span class="p">}]</span>
<span class="n">t_averaged_les</span><span class="o">=</span><span class="kc">False</span>
<span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">500.</span><span class="o">+</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span> <span class="c1"># Custom vertical grid with 10 m vertical resolution</span>
<span class="n">height_ind_2crop</span><span class="o">=</span><span class="mf">600.</span>  <span class="c1"># max height to grab from the LES</span>
<span class="n">mixing_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ql_thresh&quot;</span><span class="p">)</span>  <span class="c1"># coupled cloud - mixing from surface to cloud top</span>
<span class="n">t_harvest</span><span class="o">=</span><span class="p">(</span><span class="mi">3600</span><span class="p">,</span> <span class="mi">3600</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># starting 1 h after beginning of LES (steady-state)</span>

<span class="c1"># ABIFM</span>
<span class="n">abifm_sgp_mix</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">delta_t</span><span class="o">=</span><span class="n">delta_t</span><span class="p">,</span>
                     <span class="n">t_averaged_les</span><span class="o">=</span><span class="n">t_averaged_les</span><span class="p">,</span>
                     <span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">custom_vert_grid</span><span class="p">,</span>
                     <span class="n">aer_info</span><span class="o">=</span><span class="n">aer_info</span><span class="p">,</span>
                     <span class="n">height_ind_2crop</span><span class="o">=</span><span class="n">height_ind_2crop</span><span class="p">,</span>
                     <span class="n">mixing_bounds</span><span class="o">=</span><span class="n">mixing_bounds</span><span class="p">,</span>
                     <span class="n">t_harvest</span><span class="o">=</span><span class="n">t_harvest</span><span class="p">)</span>

<span class="c1"># Singular (DeMott et al., 2015)</span>
<span class="n">singular_sgp_mix</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">delta_t</span><span class="o">=</span><span class="n">delta_t</span><span class="p">,</span>
                     <span class="n">t_averaged_les</span><span class="o">=</span><span class="n">t_averaged_les</span><span class="p">,</span>
                     <span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">custom_vert_grid</span><span class="p">,</span>
                     <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="o">**</span><span class="n">aer_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;D2015&quot;</span><span class="p">}}],</span>  <span class="c1"># DeMott et al., 2015</span>
                     <span class="n">height_ind_2crop</span><span class="o">=</span><span class="n">height_ind_2crop</span><span class="p">,</span>
                     <span class="n">mixing_bounds</span><span class="o">=</span><span class="n">mixing_bounds</span><span class="p">,</span>
                     <span class="n">t_harvest</span><span class="o">=</span><span class="n">t_harvest</span><span class="p">)</span>

<span class="c1"># INAS (Niemand et al., 2012)</span>
<span class="n">inas_sgp_mix</span> <span class="o">=</span> <span class="n">ci_model</span><span class="p">(</span><span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">delta_t</span><span class="o">=</span><span class="n">delta_t</span><span class="p">,</span>
                     <span class="n">t_averaged_les</span><span class="o">=</span><span class="n">t_averaged_les</span><span class="p">,</span>
                     <span class="n">custom_vert_grid</span><span class="o">=</span><span class="n">custom_vert_grid</span><span class="p">,</span>
                     <span class="n">aer_info</span><span class="o">=</span><span class="p">[{</span><span class="o">**</span><span class="n">aer_info</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;ND2012&quot;</span><span class="p">}}],</span>  <span class="c1"># Niemand et al., 2012</span>
                     <span class="n">height_ind_2crop</span><span class="o">=</span><span class="n">height_ind_2crop</span><span class="p">,</span>
                     <span class="n">mixing_bounds</span><span class="o">=</span><span class="n">mixing_bounds</span><span class="p">,</span>
                     <span class="n">t_harvest</span><span class="o">=</span><span class="n">t_harvest</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.954593 s
10% of model run completed. Elapsed time: 0.65 s.
20% of model run completed. Elapsed time: 1.30 s.
30% of model run completed. Elapsed time: 1.95 s.
40% of model run completed. Elapsed time: 2.59 s.
50% of model run completed. Elapsed time: 3.23 s.
60% of model run completed. Elapsed time: 3.88 s.
70% of model run completed. Elapsed time: 4.52 s.
80% of model run completed. Elapsed time: 5.17 s.
90% of model run completed. Elapsed time: 5.81 s.

Model run finished! Total run time = 6.526533 s
Model run time stats:
Process: activation_aer: 0.91 s (13.91% of of total time)
Process: entrainment_aer: 0.51 s (7.79% of of total time)
Process: mixing_aer: 0.93 s (14.23% of of total time)
Process: sedimentation_ice: 0.51 s (7.75% of of total time)
Process: mixing_ice: 0.51 s (7.81% of of total time)
Process: data_allocation: 3.09 s (47.33% of of total time)


Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.832378 s
10% of model run completed. Elapsed time: 0.58 s.
20% of model run completed. Elapsed time: 1.17 s.
30% of model run completed. Elapsed time: 1.75 s.
40% of model run completed. Elapsed time: 2.35 s.
50% of model run completed. Elapsed time: 2.93 s.
60% of model run completed. Elapsed time: 3.52 s.
70% of model run completed. Elapsed time: 4.11 s.
80% of model run completed. Elapsed time: 4.69 s.
90% of model run completed. Elapsed time: 5.29 s.

Model run finished! Total run time = 5.938876 s
Model run time stats:
Process: activation_aer: 1.16 s (19.51% of of total time)
Process: entrainment_aer: 0.53 s (8.93% of of total time)
Process: mixing_aer: 1.16 s (19.46% of of total time)
Process: sedimentation_ice: 0.49 s (8.18% of of total time)
Process: mixing_ice: 0.51 s (8.54% of of total time)
Process: data_allocation: 2.04 s (34.38% of of total time)


Some heights were omitted because they are outside the processed LES dataset grid
Model initalization done! Total processing time = 2.820229 s
10% of model run completed. Elapsed time: 1.95 s.
20% of model run completed. Elapsed time: 3.83 s.
30% of model run completed. Elapsed time: 5.71 s.
40% of model run completed. Elapsed time: 7.61 s.
50% of model run completed. Elapsed time: 9.49 s.
60% of model run completed. Elapsed time: 11.38 s.
70% of model run completed. Elapsed time: 13.26 s.
80% of model run completed. Elapsed time: 15.14 s.
90% of model run completed. Elapsed time: 17.03 s.

Model run finished! Total run time = 19.017956 s
Model run time stats:
Process: activation_aer: 3.52 s (18.50% of of total time)
Process: entrainment_aer: 1.10 s (5.80% of of total time)
Process: mixing_aer: 6.49 s (34.14% of of total time)
Process: sedimentation_ice: 0.51 s (2.71% of of total time)
Process: mixing_ice: 0.51 s (2.70% of of total time)
Process: data_allocation: 6.73 s (35.40% of of total time)


</pre></div></div>
</div>
<p>When using INAS, <span class="math notranslate nohighlight">\(n_s(T)\)</span> is first calculated for all the values in the temperature array, determined such that the smaller temperature represents the minimum temeprature over the entire height x time LES model output (<span class="math notranslate nohighlight">\(T_{min}\)</span>), and the largest temeprature represents a temperature just above -5 C (the array bins are calcualted using an increasing bin width following a geometric progression). INP concentrations are then allocated by multiplying <span class="math notranslate nohighlight">\(n_s(T)\)</span> by the surface area of
all aerosols per diameter bin and recursively subtracting the sum of <span class="math notranslate nohighlight">\(n_s(T &gt; T_i)\)</span> from <span class="math notranslate nohighlight">\(n_s(T_i)\)</span>, where <span class="math notranslate nohighlight">\(i\)</span> designates a temperature bin, such that <span class="math notranslate nohighlight">\(\sum_{i=1}^{i=N_T} n_s(T_i)=n_s(T_{min})\)</span>, where <span class="math notranslate nohighlight">\(N_T\)</span> is the number of temperature bins. The “inp_init” field saves the initial INP height x diameter x time distribution and is shown below for a height of 400 m, in the temperature is very close to <span class="math notranslate nohighlight">\(T_{min}\)</span>. At every time step (<span class="math notranslate nohighlight">\(t\)</span>) at a given level
<span class="math notranslate nohighlight">\(h\)</span>, all allocated INP associated with <span class="math notranslate nohighlight">\(T &gt; T_{LES}(h,t)\)</span> (<span class="math notranslate nohighlight">\(T_{LES}(h,t)\)</span> is the temperature harvested from the LES output) are consumed (summed over all temperature bins, resulting in a height x diameter array) and subtracted from the total aerosol concentration array <span class="math notranslate nohighlight">\(N_{aer}(h,t,D)\)</span>, allowing direct comparison with the <span class="math notranslate nohighlight">\(N_{aer}(h,t,D)\)</span> array from ABIFM, while maintaining full consistency with the aerosol surface area and temperature dependencies of the INAS
<span class="math notranslate nohighlight">\(n_s\)</span> approach.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">inas_sgp_mix</span><span class="o">.</span><span class="n">aer</span><span class="p">[</span><span class="s2">&quot;DesertDust&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;inp_init&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">400.</span><span class="p">},</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;diam&quot;</span><span class="p">,</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x7f865a42fd90&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/Example_30_1.png" src="_images/Example_30_1.png" />
</div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="index.html"
                          title="Previous page">&larr; Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Example.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the Aerosol-Cloud Column Model (AC-1D) documentation!"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Model Run Examples and Output Notebook</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Israel Silber, Ann Fridlind.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>