


<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>run_model module &#8212; Aerosol-Cloud Column Model (AC-1D)  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">run_model module</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS overrides for cloud theme */

/* nicer titles and more space for info and warning logos */

div.admonition p.admonition-title {
    background: rgba(0, 0, 0, .05);
    margin: .5em -1em;
    margin-top: -.5em !important;
    padding: .5em .5em .5em 2.65em;
}

/* indent single paragraph */
div.admonition {
    text-indent: 20px;
}
/* don't indent multiple paragraphs */
div.admonition > p {
    text-indent: 0;
}
/* remove excessive padding */
div.admonition.inline-title p.admonition-title {
    padding-left: .2em;
}
</style>
<section id="module-run_model">
<span id="run-model-module"></span><h1>run_model module<a class="headerlink" href="#module-run_model" title="Permalink to this heading">¶</a></h1>
<p>This module is used to run the model using a ci_model object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="run_model.activate_inp">
<span class="sig-prename descclassname"><span class="pre">run_model.</span></span><span class="sig-name descname"><span class="pre">activate_inp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_aer_calc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inp_calc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_aer_curr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inp_curr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ice_curr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget_aer_act</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inp_sum_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diam_dim_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_cld_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/run_model.html#activate_inp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#run_model.activate_inp" title="Permalink to this definition">¶</a></dt>
<dd><p>Activate INP based using the appropriate method (note that n_aer_curr and n_inp_curr are not returned
as these are either None or pointers, as in the case of the ci_model object as well).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ci_model: ci_model class</strong></dt><dd><p>Containing variables such as the requested domain size, LES time averaging option
(ci_model.t_averaged_les), custom or LES grid information (ci_model.custom_vert_grid),
and LES xr.DataSet object(ci_model.les) after being processed.
All these required data are automatically set when a ci_model class object is assigned
during model initialization.</p>
</dd>
<dt><strong>key: str</strong></dt><dd><p>aerosol population name.</p>
</dd>
<dt><strong>it: int</strong></dt><dd><p>time step index.</p>
</dd>
<dt><strong>n_aer_calc: np.ndarray</strong></dt><dd><p>array containing aerosol data used for prognostic calculations.</p>
</dd>
<dt><strong>n_inp_calc: np.ndarray</strong></dt><dd><p>array containing INP data used for prognostic calculations.</p>
</dd>
<dt><strong>n_aer_curr: np.ndarray</strong></dt><dd><p>array containing current aerosol data to be updated.</p>
</dd>
<dt><strong>n_inp_curr: np.ndarray</strong></dt><dd><p>array containing current INP data to be updated.</p>
</dd>
<dt><strong>n_ice_curr: np.ndarray</strong></dt><dd><p>array containing current ice data to be updated.</p>
</dd>
<dt><strong>delta_t: float</strong></dt><dd><p>time_step [s].</p>
</dd>
<dt><strong>budget_aer_act: np.ndarray</strong></dt><dd><p>activation budget array.</p>
</dd>
<dt><strong>inp_sum_dim: int</strong></dt><dd><p>dimension to sum up when calculating total activated.</p>
</dd>
<dt><strong>diam_dim_l: int</strong></dt><dd><p>length of diameter dimension in the aer array [–INAS–or–ABIFM–].</p>
</dd>
<dt><strong>in_cld_mask: np.ndarray of bool</strong></dt><dd><p>array masking cloudy grid cells wherein activation takes place [–ABIFM–]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>n_aer_calc: np.ndarray</dt><dd><p>array containing aerosol data used for prognostic calculations.</p>
</dd>
<dt>n_inp_calc: np.ndarray</dt><dd><p>array containing INP data used for prognostic calculations.</p>
</dd>
<dt>budget_aer_act: np.ndarray</dt><dd><p>activation budget array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="run_model.place_resolved_aer">
<span class="sig-prename descclassname"><span class="pre">run_model.</span></span><span class="sig-name descname"><span class="pre">place_resolved_aer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_aer_curr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_inp_curr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/run_model.html#place_resolved_aer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#run_model.place_resolved_aer" title="Permalink to this definition">¶</a></dt>
<dd><p>Place resolved aerosol and/or INP in the ci_model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ci_model: ci_model class</strong></dt><dd><p>Containing variables such as the requested domain size, LES time averaging option
(ci_model.t_averaged_les), custom or LES grid information (ci_model.custom_vert_grid),
and LES xr.DataSet object(ci_model.les) after being processed.
All these required data are automatically set when a ci_model class object is assigned
during model initialization.</p>
</dd>
<dt><strong>key: str</strong></dt><dd><p>aerosol population name</p>
</dd>
<dt><strong>it: int</strong></dt><dd><p>time step index</p>
</dd>
<dt><strong>n_aer_curr: np.ndarray</strong></dt><dd><p>array of current aerosol state</p>
</dd>
<dt><strong>n_inp_curr: np.ndarray (singular) or None (ABIFM)</strong></dt><dd><p>array of current INP state</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="run_model.run_model">
<span class="sig-prename descclassname"><span class="pre">run_model.</span></span><span class="sig-name descname"><span class="pre">run_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/run_model.html#run_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#run_model.run_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the 1D model (output is stored in the ci_model object input to this method).
Calculations are performed using numpy arrays rather than xarray DataArray indexing, because even though
far less convenient and intuitive, numpy calculations have shown to be ~5-10 times faster than xarray (after
optimization), which becomes significant with thousands of time steps.
Note: calculations are performed in the following order (when ent_then_act is True item 2 comes prior to 1):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>aerosol activation since previous time step.</p></li>
<li><p>Cloud-top entrainment of aerosol using entrainment rate from the previous time step.</p></li>
<li><p>Turbulent mixing of aerosol using mixing depth and time scales from the previous time step (independent
from the next steps).</p></li>
<li><p>Ice sedimentation using ice fall velocity from the previous time step.</p></li>
<li><p>Turbulent mixing of ice using mixing depth and time scales from the previous time step.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ci_model: ci_model class</strong></dt><dd><p>Containing variables such as the requested domain size, LES time averaging option
(ci_model.t_averaged_les), custom or LES grid information (ci_model.custom_vert_grid),
and LES xr.DataSet object(ci_model.les) after being processed.
All these required data are automatically set when a ci_model class object is assigned
during model initialization.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="run_model.solve_entrainment">
<span class="sig-prename descclassname"><span class="pre">run_model.</span></span><span class="sig-name descname"><span class="pre">solve_entrainment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_e_ent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pblh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">implicit_solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/run_model.html#solve_entrainment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#run_model.solve_entrainment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate entrainment source using implicit or explicit method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w_e_ent: float or int</strong></dt><dd><p>PBL top entrainment rate [m/s].</p>
</dd>
<dt><strong>delta_t: float</strong></dt><dd><p>time_step [s].</p>
</dd>
<dt><strong>delta_z: float</strong></dt><dd><p>vertical spacing at PBL (cloud) top</p>
</dd>
<dt><strong>n_ft: float or np.ndarray</strong></dt><dd><p>Free-troposphere aerosol (or INP) concentration.</p>
</dd>
<dt><strong>n_pblh: float or np.ndarray</strong></dt><dd><p>PBL top aerosol (or INP) concentration.</p>
</dd>
<dt><strong>implicit_solver: bool</strong></dt><dd><p>True - using implicit solver, False - explicit solver.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>ent_src: float or np.ndarray</dt><dd><p>entrainment source.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/API/run_model.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">Aerosol-Cloud Column Model (AC-1D)  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">run_model module</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Israel Silber, Ann Fridlind.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>